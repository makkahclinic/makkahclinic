<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ุจูุงุจุฉ ุณุจุงูู ุงูุฅููุชุฑูููุฉ โ ูุฌูุน ููุฉ ุงูุทุจู ุจุงูุฒุงูุฑ (ุงูุฅุตุฏุงุฑ 2025)</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--maroon:#7B1E24;--burgundy:#C55A44;--gold:#E9C46A;}
  body{font-family:'Tajawal',sans-serif;background:linear-gradient(180deg,#fff,#faf5f4 45%,#fff);overflow-x:hidden}
  header{position:sticky;top:0;z-index:50;background:#fff;box-shadow:0 2px 10px rgba(0,0,0,.08)}
  .container{max-width:1280px;margin:0 auto}
  .hero{background:linear-gradient(180deg,var(--maroon),var(--burgundy));color:#fff;text-align:center}
  .hero-inner{padding:56px 16px 72px}
  .hero-logo-wrap{position:relative;display:inline-block}
  .hero-logo-wrap::before{content:"";position:absolute;inset:-28px;border-radius:9999px;background:
    radial-gradient(closest-side,rgba(233,196,106,.22),transparent 70%);filter:blur(1px)}
  .hero img{position:relative;z-index:1;width:150px;height:auto;filter:drop-shadow(0 0 24px var(--gold));animation:glow 3s ease-in-out infinite alternate}
  @keyframes glow{from{filter:drop-shadow(0 0 10px var(--gold))}to{filter:drop-shadow(0 0 32px var(--gold))}}
  .sidebar{width:270px;background:linear-gradient(180deg,var(--maroon),var(--burgundy));color:#fff}
  .nav-link{display:block;padding:.55rem .8rem;border-radius:.6rem;transition:.2s}
  .nav-link:hover{background-color:rgba(255,255,255,.16);transform:translateX(-3px)}
  .nav-link.active{background-color:rgba(255,255,255,.28);font-weight:700}
  .card{background:#fff;border:1px solid #eee;border-radius:14px;box-shadow:0 6px 16px rgba(0,0,0,.06)}
  .hidden{display:none!important}
  #scrollTop{position:fixed;left:18px;bottom:18px;display:none;width:48px;height:48px;border-radius:9999px;background:var(--gold);color:var(--maroon);
    box-shadow:0 8px 18px rgba(123,30,36,.35);font-size:20px}
  #scrollTop:hover{transform:scale(1.08)}
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:60}
  .modal.open{display:flex}
  .modal .panel{background:#fff;border-radius:14px;overflow:hidden;width:min(1200px,96vw)}
  /* --- FMS tabs & cards --- */
  .tabs{display:flex;gap:8px;overflow:auto;padding-bottom:8px}
  .tab{white-space:nowrap;border:1px solid #e5e7eb;border-radius:9999px;background:#fff;color:var(--maroon);
       padding:.4rem .9rem;cursor:pointer}
  .tab.active{background:var(--maroon);color:#fff;border-color:transparent}
  .cards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:14px}
  .doc-card{display:flex;flex-direction:column;gap:10px;padding:14px;border:1px solid #eee;border-radius:12px;background:#fff;height:100%}
  .doc-code{color:var(--maroon);font-weight:700}
</style>
</head>
<body class="min-h-screen">

<!-- Header -->
<header>
  <div class="container flex items-center justify-between px-4 py-3">
    <div class="flex items-center gap-3">
      <img id="logoSmall" class="h-12 w-auto rounded bg-white p-1 shadow" alt="ุดุนุงุฑ ุงููุฌูุน">
      <button id="btnSetLogo" class="text-[var(--maroon)] text-sm underline underline-offset-4 hover:text-[var(--burgundy)]">
        ุชุบููุฑ/ุชุญุฏูุซ ุงูุดุนุงุฑ
      </button>
      <input id="logoPicker" type="file" accept="image/*" class="hidden">
    </div>
    <div class="text-center">
      <div class="text-lg md:text-xl font-bold text-gray-800">ุจูุงุจุฉ ุณุจุงูู ุงูุฅููุชุฑูููุฉ</div>
      <div class="text-xs md:text-sm text-gray-500">ูุฌูุน ููุฉ ุงูุทุจู ุจุงูุฒุงูุฑ โ ุงูุฅุตุฏุงุฑ 2025</div>
    </div>
    <div class="flex items-center gap-2">
      <a href="https://m2020m.org" target="_blank" class="px-3 py-2 rounded text-[var(--maroon)] hover:bg-gray-100">๐ฅ ูููุน ุงููุฌูุน</a>
      <button onclick="window.print()" class="bg-[var(--maroon)] hover:bg-[var(--burgundy)] text-white px-4 py-2 rounded"><i class="fas fa-print ml-2"></i> ุทุจุงุนุฉ / PDF</button>
    </div>
  </div>
</header>

<!-- Hero -->
<section class="hero">
  <div class="hero-inner container">
    <div class="hero-logo-wrap"><img id="logoHero" alt="ุดุนุงุฑ ูุฌูุน ููุฉ ุงูุทุจู"></div>
    <h1 class="text-3xl md:text-4xl font-bold mt-4">ุจูุงุจุฉ ุณุจุงูู ุงูุฅููุชุฑูููุฉ</h1>
    <p class="text-base md:text-lg opacity-95 mt-1">ูุฌูุน ููุฉ ุงูุทุจู ุจุงูุฒุงูุฑ โ ุงูุฅุตุฏุงุฑ 2025</p>
    <div class="text-[13px] md:text-[14px] mt-2" style="color:#f8e8cc">ุจูุงุจุฉ ุฏุงุฎููุฉ ูุฅุฏุงุฑุฉ ุงููุซุงุฆู ูุงููุนุงููุฑ โ ูุง ุชุชุถูู ุฃู ุงุฏุนุงุก ุจุงูุญุตูู ุนูู ุงูุงุนุชูุงุฏ.</div>
  </div>
</section>

<!-- Layout -->
<div class="container px-4 py-6 flex gap-6">
  <!-- Sidebar | ุงูุชุฑุชูุจ ููุง ุทูุจุช -->
  <aside class="sidebar rounded-xl p-4 h-max sticky top-[92px]">
    <div class="font-bold mb-2 text-lg">๐ ุฃูุณุงู ุงูุจูุงุจุฉ</div>
    <a class="nav-link active" href="#home"       onclick="navTo('home')">๐ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>
    <a class="nav-link"        href="#manuals"    onclick="navTo('manuals')">๐ ุงูุฏููู ุงูุฅุฏุงุฑู</a>
    <a class="nav-link"        href="#leadership" onclick="navTo('leadership')">๐๏ธ ุงูููุงุฏุฉ ูุงูุญูููุฉ (LD)</a>
    <a class="nav-link"        href="#committees" onclick="navTo('committees')">๐ฅ ุงููุฌุงู ุงูุฑุณููุฉ</a>
    <a class="nav-link"        href="#rm"         onclick="navTo('rm')">โ๏ธ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ (RM)</a>
    <a class="nav-link"        href="#fms"        onclick="navTo('fms')">๐๏ธ ุงูุณูุงูุฉ ูุงููุฑุงูู (FMS)</a>
    <!-- ุฃูุณุงู ููุฌุงู ุงูุฃุฎุฑู (ุฑูุงุจุท/ููุงุทุน ูุฎุชุตุฑุฉ ููุขู) -->
    <a class="nav-link"        href="#psc"        onclick="navTo('psc')">๐งฏ ุณูุงูุฉ ุงููุฑุถู (PSC)</a>
    <a class="nav-link"        href="#ipc"        onclick="navTo('ipc')">๐งผ ููุงูุญุฉ ุงูุนุฏูู (IPC)</a>
    <a class="nav-link"        href="#qi"         onclick="navTo('qi')">๐ ุงูุฌูุฏุฉ ูุงูุชุญุณูู (QI)</a>
    <a class="nav-link"        href="#eoc"        onclick="navTo('eoc')">๐จ ุงูุทูุงุฑุฆ ูุงูููุงุฑุซ (EOC)</a>
    <!-- ุงูุณุฌู ุงูุฅููุชุฑููู ูุขุฎุฑ ุจูุฏ -->
    <a class="nav-link" target="_blank"
       href="https://docs.google.com/spreadsheets/d/1cGxMCYqGfPH2UiE-nsCoytIRjIPSDYxutnq04XF5YGs/edit?gid=597653922#gid=597653922">๐๏ธ ุงูุณุฌู ุงูุฅููุชุฑููู (Google Sheet)</a>
  </aside>

  <!-- Main -->
  <main id="main" class="flex-1 space-y-6">

    <!-- ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ: ุงูุฑุณุงูุฉ + ุฑุงุจุท ุงููุซููุฉ -->
    <section id="home" class="card p-6">
      <h2 class="text-2xl font-bold text-[var(--maroon)] mb-3">๐ ุงูุฑุณุงูุฉ (Mission Statement)</h2>
      <p class="text-gray-700 leading-8 text-[1.05rem]">
        "ููุชุฒู ุจุชูุฏูู ุฑุนุงูุฉ ุตุญูุฉ ุฃูููุฉ ูุชุฎุตุตูุฉ ุขููุฉ ููุชูุญูุฑุฉ ุญูู ุงููุฑูุถ ูู ููุทูุฉ ููุฉ ุงูููุฑูุฉุ ูู ุฎูุงู ูุฑูู ุนูู
        ูุคูู ููุฑุงูู ูุชุทูุฑุฉุ ูุชุนุฒูุฒ ุตุญุฉ ุงููุฌุชูุน ูุงููุตูู ูุฃุนูู ูุณุชููุงุช ุงูุฌูุฏุฉ."
      </p>
      <div class="mt-4 flex items-center gap-3">
        <button class="bg-[var(--maroon)] hover:bg-[var(--burgundy)] text-white px-4 py-2 rounded"
                onclick="openDoc('ูุซููุฉ ุงูุฑุณุงูุฉุ ุงูุฑุคูุฉุ ูุงูููู ุงูููุนุชูุฏุฉ (LD.4.2)','https://docs.google.com/document/d/1YUE5GKeQmY3rrHk1j3dX3ztPAwX_3GdNjG9fB_fjPsQ/preview')">
          ๐ ุนุฑุถ ยซูุซููุฉ ุงูุฑุณุงูุฉุ ุงูุฑุคูุฉุ ูุงูููู (LD.4.2)ยป
        </button>
        <a class="text-[var(--maroon)] underline underline-offset-4"
           href="https://docs.google.com/document/d/1YUE5GKeQmY3rrHk1j3dX3ztPAwX_3GdNjG9fB_fjPsQ/edit?usp=drive_link"
           target="_blank">โ ูุชุญ ุงููุณุชูุฏ ูู ุชุจููุจ</a>
      </div>
    </section>

    <!-- ุงูุฏููู ุงูุฅุฏุงุฑู ูุงูุชูุธููู -->
    <section id="manuals" class="card p-6 hidden">
      <h2 class="text-2xl font-bold text-[var(--maroon)] mb-4">๐ ุงูุฏููู ุงูุฅุฏุงุฑู ูุงูุชูุธููู</h2>

      <!-- ูุฎุทุท ูุฑูู ูุฎุชุตุฑ ุฏุงุฎู ุงูุตูุญุฉ -->
      <div class="card p-5 mb-5">
        <h3 class="font-bold text-[var(--maroon)] mb-3">ุงููุฎุทุท ุงูุชูุธููู (ุนุฑุถ ูุฑูู ูุฎุชุตุฑ)</h3>
        <div class="flex flex-col items-center">
          <div class="p-3 rounded bg-[var(--maroon)] text-white font-bold">ุงููุฏูุฑ ุงูุนุงู / ุงููุงูู โ ุฏ. ุญุณูู ุจุงุจุตูู</div>
          <div class="w-1 h-6 bg-gray-300 my-2"></div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
            <div class="p-3 rounded border">ุงูุฅุฏุงุฑุฉ ุงูุฅุฏุงุฑูุฉ โ ุฃ. ุจูุงู ูุชู</div>
            <div class="p-3 rounded border">ุงูุฅุฏุงุฑุฉ ุงูุทุจูุฉ โ ุฏ. ูุนุงุฐ (ูุงุฆุจ: ุฏ. ุฎุงูุฏ)</div>
            <div class="p-3 rounded border">ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ ูุงูุชุฃููู โ ุฃ. ุตุงุจุฑ ุนุจุฏู</div>
          </div>
          <div class="w-1 h-6 bg-gray-300 my-2"></div>
          <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
            <div class="p-3 rounded border">ุงูุตูุงูุฉ ูุงููุฑุงูู โ ุฃ. ุนุฏูุงู</div>
            <div class="p-3 rounded border">ุงูุตูุฏููุฉ โ ุฃ. ุนุจุฏุงููู</div>
            <div class="p-3 rounded border">ุงููุฎุชุจุฑ โ ุฃ. ููุซู</div>
            <div class="p-3 rounded border">ุงูุฃุดุนุฉ โ ุฃ. ุจูุงู</div>
          </div>
        </div>
      </div>

      <!-- ุฑูุงุจุท ุงูุฏููู ุงููุฎุชุตุฑ ูุงูุชูุตููู -->
      <div class="flex flex-wrap gap-2">
        <button class="px-3 py-2 rounded bg-[var(--maroon)] text-white"
                onclick="openDoc('ุงูุฏููู ุงูุชูุธููู ุงููุฎุชุตุฑ','https://docs.google.com/document/d/1jGkTVk6WJeWvCnMw62NXZJ_qj9UL3fychiKmJCpR-ZE/preview')">
          ๐ ุงูุฏููู ุงูุชูุธููู ุงููุฎุชุตุฑ
        </button>
        <a class="px-3 py-2 rounded border text-[var(--maroon)]" target="_blank"
           href="https://docs.google.com/document/d/1jGkTVk6WJeWvCnMw62NXZJ_qj9UL3fychiKmJCpR-ZE/edit?tab=t.0">โ ูุชุญ (ูุฎุชุตุฑ)</a>

        <button class="px-3 py-2 rounded bg-[var(--maroon)] text-white"
                onclick="openDoc('ุงูุฏููู ุงูุฅุฏุงุฑู ุงูุชูุธููู ุงูุชูุตููู','https://docs.google.com/document/d/1hswi3r_fTUKQoVIj3lG9kEIQpFF7Ol7OLCXe3A45-Ao/preview#heading=h.93zeqi5ae78k')">
          ๐ ุงูุฏููู ุงูุฅุฏุงุฑู ุงูุชูุธููู ุงูุชูุตููู
        </button>
        <a class="px-3 py-2 rounded border text-[var(--maroon)]" target="_blank"
           href="https://docs.google.com/document/d/1hswi3r_fTUKQoVIj3lG9kEIQpFF7Ol7OLCXe3A45-Ao/edit?tab=t.0#heading=h.93zeqi5ae78k">โ ูุชุญ (ุชูุตููู)</a>
      </div>
    </section>

    <!-- ุงูููุงุฏุฉ ูุงูุญูููุฉ -->
    <section id="leadership" class="card p-6 hidden">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold text-[var(--maroon)]">๐๏ธ ุงูููุงุฏุฉ ูุงูุญูููุฉ (LD)</h2>
        <div class="flex gap-2 flex-wrap">
          <button class="px-3 py-2 rounded bg-[var(--maroon)] text-white"
                  onclick="openDoc('ูุฑุงุฑ ุงูุชุนููู','https://docs.google.com/document/d/1sZC9bpoqlOgJDN-akgPt5wYrpGC5bvdo-2VL7ZIKCvM/preview')">๐ ูุฑุงุฑ ุงูุชุนููู</button>
          <button class="px-3 py-2 rounded bg-[var(--maroon)] text-white"
                  onclick="openDoc('ูุฑุงุฑ ุชุนููู ุงููุงุฏุฉ','https://docs.google.com/document/d/1LeyR6WnpUVth3hfr8UX2i5QKIHegA6RvKpkgEhfamA4/preview')">๐ ูุฑุงุฑ ุชุนููู ุงููุงุฏุฉ</button>
          <a class="px-3 py-2 rounded border text-[var(--maroon)]" target="_blank"
             href="https://docs.google.com/document/d/1LeyR6WnpUVth3hfr8UX2i5QKIHegA6RvKpkgEhfamA4/edit?tab=t.0">๐จ๏ธ ุชูุฒูู/ุทุจุงุนุฉ</a>
        </div>
      </div>

      <!-- ุจุทุงูุฉ ุงููุงุฆุฏ -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
        <div class="card p-5 lg:col-span-1">
          <div class="flex items-center gap-4">
            <div class="h-16 w-16 rounded-full bg-gradient-to-br from-[var(--maroon)] to-[var(--burgundy)] text-white flex items-center justify-center text-2xl font-bold">ุญ</div>
            <div>
              <div class="text-lg font-bold">ุงููุฏูุฑ ุงูุนุงู / ุงููุงูู</div>
              <div class="text-[var(--maroon)] font-bold">ุฏ. ุญุณูู ุจู ูุญูุฏ ุญุณู ุดูุฎ ุจุงุจุตูู</div>
              <div class="text-gray-500 text-sm mt-1">ุงููุงุฆุฏ ุงูุชูููุฐู ูููุฌูุน</div>
            </div>
          </div>
          <div class="mt-4 text-gray-700 text-sm leading-7">
            ูุชุจุน ุฅุฏุงุฑููุง ููุฌูุณ ุงูุฅุฏุงุฑุฉ/ุงููุงููุ ููุดุฑู ุนูู ุงููุฏูุฑ ุงูุทุจูุ ุงูุชูุฑูุถุ ุงูุนูุงุฏุงุชุ ุงูุฎุฏูุงุช ุงููุณุงูุฏุฉุ ูุงูุฃูุณุงู ุงูุฅุฏุงุฑูุฉ. :contentReference[oaicite:0]{index=0}
          </div>
        </div>

        <!-- ุฌุฏูู ุงูููุงุฏุงุช ุงูุชูููุฐูุฉ -->
        <div class="card p-5 lg:col-span-2">
          <h3 class="font-bold text-[var(--maroon)] mb-3">ุงูุฅุฏุงุฑุงุช ุงูุชูููุฐูุฉ (ุญุณุจ ุงูุนุฑุถ ุงููุนุชูุฏ)</h3>
          <div class="overflow-x-auto">
            <table class="min-w-full text-right border">
              <thead class="bg-gray-100">
                <tr><th class="p-2 border">ุงููุณู</th><th class="p-2 border">ุงููุฏูุฑ</th><th class="p-2 border">ุงูููุงู ุงูุฃุณุงุณูุฉ</th></tr>
              </thead>
              <tbody>
                <tr><td class="p-2 border">ุงูุฅุฏุงุฑุฉ ุงูุฅุฏุงุฑูุฉ</td><td class="p-2 border">ุฃ. ุจูุงู ูุชู</td><td class="p-2 border">ุงูุชุดุบูู ุงูููููุ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉุ ุงูุชุฏุฑูุจุ ุงูุงุณุชูุจุงู ูุงูููุงุนูุฏ.</td></tr>
                <tr><td class="p-2 border">ุงูุฅุฏุงุฑุฉ ุงูุทุจูุฉ</td><td class="p-2 border">ุฏ. ูุนุงุฐ ุงูุจููุด (ูุงุฆุจ: ุฏ. ุฎุงูุฏ ุงูุฎุทูุจ)</td><td class="p-2 border">ุงูุฅุดุฑุงู ุนูู ุงูุนูุงุฏุงุช ูุงูุฎุฏูุงุช ุงูุณุฑูุฑูุฉ ูุฌูุฏุชูุง.</td></tr>
                <tr><td class="p-2 border">ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ ูุงูุชุฃููู</td><td class="p-2 border">ุฃ. ุตุงุจุฑ ุนุจุฏู</td><td class="p-2 border">ุงูุญุณุงุจุงุชุ ุงููุทุงูุจุงุชุ ุฅุฏุงุฑุฉ ุฏูุฑุฉ ุงูุฅูุฑุงุฏุ ุงูุชูุงุฑูุฑ ุงููุงููุฉ.</td></tr>
                <tr><td class="p-2 border">ุงูุตูุงูุฉ ูุงููุฑุงูู</td><td class="p-2 border">ุฃ. ุนุฏูุงู ุงูุฑูุงุนู</td><td class="p-2 border">ุงูุตูุงูุฉ ุงูููุงุฆูุฉุ ุงูุณูุงูุฉ ุงููุฑุงูููุฉุ ุงูุทูุงุฑุฆุ ุงููุดุชุฑูุงุช ุบูุฑ ุงูุทุจูุฉุ ุงููุธุงูุฉ.</td></tr>
                <tr><td class="p-2 border">ุงูุตูุฏููุฉ</td><td class="p-2 border">ุฃ. ุนุจุฏุงููู ุญููุฏู</td><td class="p-2 border">ุงูุตุฑู ุงูุฏูุงุฆู ุงูุขููุ ุถุจุท ุงูุฃุฏููุฉ ุนุงููุฉ ุงูุฎุทูุฑุฉุ ุณูุณูุฉ ุงูุชุจุฑูุฏุ ุงููุฎุฒูู.</td></tr>
                <tr><td class="p-2 border">ุงููุฎุชุจุฑ</td><td class="p-2 border">ุฃ. ููุซู ุงูุฌุนูู</td><td class="p-2 border">ุถุจุท ุงูุฌูุฏุฉ ุงููุฎุจุฑูุฉุ ุณูุงูุฉ ุงูุนููุงุชุ ุงูุณูุงูุฉ ุงูุญูููุฉ.</td></tr>
                <tr><td class="p-2 border">ุงูุฃุดุนุฉ</td><td class="p-2 border">ุฃ. ุจูุงู ูุชู</td><td class="p-2 border">ุงูุฅุดุฑุงู ุงูููู ูุงูุฅุดุนุงุนู ููู ูุชุทูุจุงุช NRRC.</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ุงููุฌุงู ุงูุฑุณููุฉ -->
    <section id="committees" class="card p-6 hidden">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-2xl font-bold text-[var(--maroon)]">๐ฅ ุงููุฌุงู ุงูุฑุณููุฉ (ุญุณุจ ุณุจุงูู)</h2>
        <div class="flex gap-2">
          <button class="px-3 py-2 rounded bg-[var(--maroon)] text-white"
                  onclick="openDoc('ุงูููู ุงููุฎุชุตุฑ โ ุงููุฌุงู','https://docs.google.com/document/d/1jGkTVk6WJeWvCnMw62NXZJ_qj9UL3fychiKmJCpR-ZE/preview')">๐ ุนุฑุถ (ูุฎุชุตุฑ)</button>
          <a class="px-3 py-2 rounded border text-[var(--maroon)]" target="_blank"
             href="https://docs.google.com/document/d/1jGkTVk6WJeWvCnMw62NXZJ_qj9UL3fychiKmJCpR-ZE/edit?tab=t.0">โ ูุชุญ</a>
        </div>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full text-right border">
          <thead class="bg-gray-100">
            <tr>
              <th class="p-2 border">ุงูุฑูุฒ</th>
              <th class="p-2 border">ุงุณู ุงููุฌูุฉ</th>
              <th class="p-2 border">ุงูุฑุฆูุณ</th>
              <th class="p-2 border">ุงูููุณู/ุงูุณูุฑุชูุฑ + ุงูุฃุนุถุงุก</th>
              <th class="p-2 border">ุชูุฑุงุฑ ุงูุงุฌุชูุงุนุงุช</th>
            </tr>
          </thead>
          <tbody>
            <tr><td class="p-2 border">RM</td><td class="p-2 border">ูุฌูุฉ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ</td><td class="p-2 border">ุฏ. ุญุณูู ุจุงุจุตูู</td><td class="p-2 border">ุงูููุณู/ุงูุณูุฑุชูุฑ: ุฃ. ุนุฏูุงู ุงูุฑูุงุนู โ ุงูุฃุนุถุงุก: ุจูุงูุ ุตุงุจุฑุ ูุนุงุฐุ ุฎุงูุฏ</td><td class="p-2 border">ุดูุฑููุง</td></tr>
            <tr><td class="p-2 border">FMS</td><td class="p-2 border">ูุฌูุฉ ุงูุณูุงูุฉ ูุงููุฑุงูู</td><td class="p-2 border">ุฃ. ุตุงุจุฑ ุนุจุฏู</td><td class="p-2 border">ููุณู ุงูุชุฏุฑูุจ: ุฃ. ุจูุงู ูุชู โ ุงูุฃุนุถุงุก: ุนุฏูุงู ุงูุฑูุงุนูุ ุฎุงูุฏ ุงูุฎุทูุจุ ููุฏูุจ ุงูุฃูู</td><td class="p-2 border">ุดูุฑููุง</td></tr>
            <tr><td class="p-2 border">PSC</td><td class="p-2 border">ูุฌูุฉ ุณูุงูุฉ ุงููุฑุถู</td><td class="p-2 border">ุฏ. ูุนุงุฐ ุงูุจููุด</td><td class="p-2 border">ูุงุฆุจ ุงูุฑุฆูุณ: ุฏ. ุฎุงูุฏ ุงูุฎุทูุจ โ ุงูุฃุนุถุงุก: ุฏ. ุญุณููุ ููุซูุ ุจูุงู โ ุงูุณูุฑุชูุฑ: ุนุฏูุงู</td><td class="p-2 border">ุดูุฑููุง</td></tr>
            <tr><td class="p-2 border">IPC</td><td class="p-2 border">ูุฌูุฉ ููุงูุญุฉ ุงูุนุฏูู</td><td class="p-2 border">ุฏ. ูุฌุฏู ุนุณูุฑ</td><td class="p-2 border">ุงูุฃุนุถุงุก: ุฎุงูุฏุ ุงูุชูุฑูุถุ ุงููุฎุชุจุฑุ ุงูุชุนููู โ ุงูุณูุฑุชูุฑ: ุนุฏูุงู</td><td class="p-2 border">ุดูุฑููุง</td></tr>
            <tr><td class="p-2 border">QI</td><td class="p-2 border">ูุฌูุฉ ุงูุฌูุฏุฉ ูุงูุชุญุณูู ุงููุณุชูุฑ</td><td class="p-2 border">ุฏ. ุญุณูู ุจุงุจุตูู</td><td class="p-2 border">ุงูุฃุนุถุงุก: ููุซููู ูู ุงูุฃูุณุงู โ ุงูุณูุฑุชูุฑ: ุนุฏูุงู</td><td class="p-2 border">ุฑุจุน ุณููู</td></tr>
            <tr><td class="p-2 border">EOC</td><td class="p-2 border">ูุฌูุฉ ุงูุทูุงุฑุฆ ูุงูููุงุฑุซ</td><td class="p-2 border">ุฃ. ุจูุงู ูุชู</td><td class="p-2 border">ุงูุฃุนุถุงุก: ุตุงุจุฑุ ูุนุงุฐุ ุฎุงูุฏุ ุงูุฃููุ ุงูุชูุฑูุถ</td><td class="p-2 border">ูุตู ุณููู</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ (RM) -->
    <section id="rm" class="card p-6 hidden">
      <h2 class="text-2xl font-bold text-[var(--maroon)] mb-2">โ๏ธ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ (RM)</h2>
      <p class="text-gray-600 mb-4">ุงููุญุชูู ูุฑุชูุจ ุญุณุจ ูุง ุชุทูุจู ุณุจุงูู: ูุฑุงุฑุงุช ุงูุจุฑูุงูุฌุ ููุงุฐุฌ ุงูุจูุงุบุ ุฃุฏูุงุช ุงูุชุญููู (RCA/HFMEA)ุ ุงูููุญุงุชุ ุงูุณุฌู ุงููุคุณุณูุ ูุงูุชุฏุฑูุจ.</p>

      <!-- ุฃูุณูุฉ ูุฆุงุช RM -->
      <div id="rmTabs" class="tabs mb-3"></div>
      <div id="rmGrid" class="cards-grid"></div>

      <!-- ุงูุจูุงุบ ุงูุฅููุชุฑููู + ุญุถูุฑ ูุชุฏุฑุจ -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
        <div class="card p-4">
          <div class="font-bold text-[var(--maroon)] mb-2">๐ ุงูุจูุงุบ ุงูุฅููุชุฑููู ููุดูุงูู ูุงูุญูุงุฏุซ</div>
          <p class="text-gray-700 text-sm mb-3">ุงุณุชุฎุฏู ุงููููุฐุฌ ุงูุฅููุชุฑููู ุงูุชุงูู ูุชุณุฌูู ุงูุดููู/ุงูุญุงุฏุซ ูุณููุฑุณู ูููุฑูู ุงููุฎุชุต:</p>
          <a class="bg-[var(--maroon)] text-white px-4 py-2 rounded inline-block"
             target="_blank" href="https://www.m2020m.org/report.html">๐ ูุชุญ ูููุฐุฌ ุงูุจูุงุบ ุงูุฅููุชุฑููู</a>
        </div>

        <div class="card p-4">
          <div class="font-bold text-[var(--maroon)] mb-2">๐ข ุงูุชูุนูุฉ ูุงูุชุฏุฑูุจ โ ุชุณุฌูู ุญุถูุฑ ูุชุฏุฑุจ</div>
          <form id="trainingForm" class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="md:col-span-1"><label class="text-sm">ุงุณู ุงููุชุฏุฑุจ*</label><input name="trainee_name" required class="w-full border rounded px-3 py-2"></div>
            <div class="md:col-span-1"><label class="text-sm">ููุถูุน ุงูุชุฏุฑูุจ*</label><input name="training_topic" required class="w-full border rounded px-3 py-2"></div>
            <div class="md:col-span-1"><label class="text-sm">ุชุงุฑูุฎ ุงูุชุฏุฑูุจ*</label><input type="date" name="training_date" required class="w-full border rounded px-3 py-2"></div>
            <div class="md:col-span-1"><label class="text-sm">ููุงู ุงูุชุฏุฑูุจ*</label><input name="training_place" required class="w-full border rounded px-3 py-2"></div>
            <div class="md:col-span-2 flex items-center gap-3">
              <button class="bg-[var(--maroon)] hover:bg-[var(--burgundy)] text-white px-4 py-2 rounded" type="submit">ุญูุธ ุงูุญุถูุฑ</button>
              <span id="trainingMsg" class="text-sm"></span>
            </div>
          </form>
          <p class="text-xs text-gray-500 mt-2">* ุงุฑุจุท ูุฐุง ุงููููุฐุฌ ุจู Google Apps Script ุนุจุฑ ุงููุชุบููุฑ <code>TRAINING_API_URL</code> ุฃุฏูุงู.</p>
        </div>
      </div>
    </section>

    <!-- ุงูุณูุงูุฉ ูุงููุฑุงูู (FMS) -->
    <section id="fms" class="card p-6 hidden">
      <h2 class="text-2xl font-bold text-[var(--maroon)] mb-2">๐๏ธ ููุชุจุฉ ูุซุงุฆู FMS 2025</h2>
      <p class="text-gray-600 mb-4">ุงุฎุชุฑ ุงูุชุตููู ูุนุฑุถ ุงููุซุงุฆู ูุจุทุงูุงุช ุฃูููุฉ ูุฑูุฉ.</p>

      <div id="fmsTabs" class="tabs mb-3"></div>

      <div class="flex items-center gap-2 mb-3">
        <input id="fmsSearch" class="border rounded px-3 py-2 w-full md:w-1/2" placeholder="ุจุญุซ ุจุงูุฑูุฒ ุฃู ุงูุนููุงู...">
        <button class="px-3 py-2 rounded border" onclick="document.getElementById('fmsSearch').value=''; renderFms()">ูุณุญ ุงูุจุญุซ</button>
      </div>

      <div id="fmsGrid" class="cards-grid"></div>

      <hr class="my-6">
      <h3 class="text-xl font-bold text-[var(--maroon)] mb-2">๐ ูููุฐุฌ ุฌููุฉ ุงูุณูุงูุฉ (ูุฑุณู ุฅูู Google Sheet)</h3>
      <form id="roundForm" class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <div><label class="text-sm">ุงุณู ุงููุฑุงูุจ*</label><input required name="inspector" class="w-full border rounded px-3 py-2"></div>
        <div><label class="text-sm">ุงููููุน/ุงููุณู*</label><input required name="location" class="w-full border rounded px-3 py-2"></div>
        <div>
          <label class="text-sm">ุงูุฃููููุฉ*</label>
          <select name="priority" class="w-full border rounded px-3 py-2">
            <option>ุนุงููุฉ (High)</option><option selected>ูุชูุณุทุฉ (Medium)</option><option>ููุฎูุถุฉ (Low)</option>
          </select>
        </div>
        <div class="md:col-span-3"><label class="text-sm">ุงูููุงุญุธุฉ ูุงูุชูุตูุฉ*</label><textarea required name="observation" rows="3" class="w-full border rounded px-3 py-2"></textarea></div>
        <div class="md:col-span-3 flex items-center gap-3">
          <button class="bg-[var(--maroon)] hover:bg-[var(--burgundy)] text-white px-4 py-2 rounded" type="submit">ุฅุฑุณุงู ุงูููุงุญุธุฉ</button>
          <a target="_blank" class="bg-[var(--gold)] text-[var(--maroon)] px-4 py-2 rounded shadow" href="https://docs.google.com/spreadsheets/d/1cGxMCYqGfPH2UiE-nsCoytIRjIPSDYxutnq04XF5YGs/edit?gid=597653922">๐ ุนุฑุถ ุขุฎุฑ ุงูุฌููุงุช ุงููุณุฌูุฉ</a>
          <span id="roundMsg" class="text-sm"></span>
        </div>
      </form>
    </section>

    <!-- ุฃูุณุงู ูุฎุชุตุฑุฉ ูููุฌุงู ุงูุฃุฎุฑู (Placeholders ููุชูุณูุน ูุงุญููุง) -->
    <section id="psc" class="card p-6 hidden"><h2 class="text-2xl font-bold text-[var(--maroon)] mb-2">๐งฏ ุณูุงูุฉ ุงููุฑุถู (PSC)</h2><p class="text-gray-600">ุณูุงุณุงุช ูููุงุฐุฌ ุณูุงูุฉ ุงููุฑุถู โ ููุณุชููู ูุงุญููุง.</p></section>
    <section id="ipc" class="card p-6 hidden"><h2 class="text-2xl font-bold text-[var(--maroon)] mb-2">๐งผ ููุงูุญุฉ ุงูุนุฏูู (IPC)</h2><p class="text-gray-600">ุฎุทุท ูุณูุงุณุงุช ููุงูุญุฉ ุงูุนุฏูู โ ููุณุชููู ูุงุญููุง.</p></section>
    <section id="qi"  class="card p-6 hidden"><h2 class="text-2xl font-bold text-[var(--maroon)] mb-2">๐ ุงูุฌูุฏุฉ ูุงูุชุญุณูู (QI)</h2><p class="text-gray-600">ูุคุดุฑุงุช ุงูุฌูุฏุฉ ููุดุงุฑูุน ุงูุชุญุณูู โ ููุณุชููู ูุงุญููุง.</p></section>
    <section id="eoc" class="card p-6 hidden"><h2 class="text-2xl font-bold text-[var(--maroon)] mb-2">๐จ ุงูุทูุงุฑุฆ ูุงูููุงุฑุซ (EOC)</h2><p class="text-gray-600">ุฎุทุท ุงูููุงุฑุซ ูุงูุฅุฎูุงุก ูุงูุชูุงุฑูู โ ููุณุชููู ูุงุญููุง.</p></section>

  </main>
</div>

<!-- Modal ูุนุฑุถ ุงููุณุชูุฏุงุช -->
<div id="docModal" class="modal" role="dialog" aria-modal="true">
  <div class="panel">
    <div class="flex items-center justify-between px-4 py-3 border-b">
      <div id="docTitle" class="font-bold text-[var(--maroon)]">ุนุฑุถ ุงููุซููุฉ</div>
      <button class="text-2xl" onclick="closeDoc()">ร</button>
    </div>
    <div class="p-0"><iframe id="docFrame" class="w-full" style="height:74vh" src="about:blank"></iframe></div>
    <div class="px-4 py-3 border-t text-left"><button class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300" onclick="closeDoc()">ุฅุบูุงู</button></div>
  </div>
</div>

<!-- Scroll To Top -->
<button id="scrollTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" title="ุฃุนูู">โฌ๏ธ</button>

<footer class="text-center text-sm text-white py-4 mt-10" style="background:var(--maroon)">ยฉ 2025 ูุฌูุน ููุฉ ุงูุทุจู ุจุงูุฒุงูุฑ.</footer>

<script>
/* ===== ุงูุดุนุงุฑ (ูุญูุธ Base64 ูุญูููุง) ===== */
(function initLogo(){
  const fallback = "data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='180' height='180' viewBox='0 0 180 180'>\
<defs><linearGradient id='g' x1='0' y1='0' x2='0' y2='1'><stop offset='0%' stop-color='%237B1E24'/><stop offset='100%' stop-color='%23C55A44'/></linearGradient></defs>\
<circle cx='90' cy='90' r='88' fill='url(%23g)'/>\
<text x='50%' y='52%' font-size='52' text-anchor='middle' fill='white' font-family='Arial' dy='.35em'>MC</text>\
</svg>";
  const b64 = localStorage.getItem('logoBase64');
  const src = b64 || fallback;
  document.getElementById('logoSmall').src = src;
  document.getElementById('logoHero').src  = src;
})();
document.getElementById('btnSetLogo').addEventListener('click',()=>document.getElementById('logoPicker').click());
document.getElementById('logoPicker').addEventListener('change',e=>{
  const f=e.target.files[0]; if(!f) return;
  const r=new FileReader(); r.onload=()=>{localStorage.setItem('logoBase64',r.result);
    document.getElementById('logoSmall').src=r.result;document.getElementById('logoHero').src=r.result;
    alert('โ ุชู ุชุญุฏูุซ ุงูุดุนุงุฑ ูุญูุธู ูุญูููุง.');}; r.readAsDataURL(f);
});

/* ===== ุชูููู ุงูุฃูุณุงู + ุฒุฑ ุฃุนูู ุงูุตูุญุฉ ===== */
function navTo(id){
  document.querySelectorAll('main > section').forEach(s=>s.classList.add('hidden'));
  const sec = document.getElementById(id); if(sec){sec.classList.remove('hidden');}
  document.querySelectorAll('.sidebar .nav-link').forEach(a=>a.classList.remove('active'));
  const link = document.querySelector('.sidebar .nav-link[href="#'+id+'"]'); if(link) link.classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
}
window.addEventListener('scroll',()=>{document.getElementById('scrollTop').style.display=(window.scrollY>220)?'block':'none'});

/* ===== ุนุงุฑุถ ุงููุณุชูุฏุงุช ===== */
function openDoc(title,url){ document.getElementById('docTitle').textContent=title; document.getElementById('docFrame').src=toPreview(url); document.getElementById('docModal').classList.add('open'); }
function closeDoc(){ document.getElementById('docModal').classList.remove('open'); document.getElementById('docFrame').src='about:blank'; }
function toPreview(u){
  try{
    const url=new URL(u);
    if(url.hostname.includes('drive.google.com')){ const id=url.searchParams.get('id'); if(id) return 'https://drive.google.com/file/d/'+id+'/preview'; }
    if(url.hostname.includes('docs.google.com')){ return u.replace('/edit','/preview'); }
  }catch(e){}
  return u;
}

/* ===== ููุชุจุฉ FMS (ุฑูุงุจุทูู) ===== */
const FMS_DOCS = [
  {code:'POL-FMS-2025-001',name:'ุณูุงุณุฉ ุฅุฏุงุฑุฉ ุงูุณูุงูุฉ ูุงููุฑุงูู',cat:'POL',url:'https://drive.google.com/open?id=1YS1Jk5FgwJoY5in71yUQ1oIjE4JEsaecMGWTt00aQ0o'},
  {code:'POL-FMS-2025-015',name:'ุณูุงุณุฉ ูุฑุงูุจุฉ ุฌูุฏุฉ ุงูููุงุก ูุงูุชูููุฉ',cat:'POL',url:'https://drive.google.com/open?id=18caApXqHeQSZdBFSvgyIKICX0qMSsN7UuRxz3u7R10o'},
  {code:'SOP-FMS-2025-002',name:'ุฅุฌุฑุงุกุงุช ุงูุชุดุบูู ุงูููุงุณูุฉ ููุฌููุงุช ููุญุต ุงูุฃูุธูุฉ',cat:'SOP',url:'https://drive.google.com/open?id=1mrKI8YTjSphAk-noRO8sp9GhYYLzR1FCBti2EDyDZOU'},
  {code:'DEC-FMS-2025-001',name:'ูุฑุงุฑ ุชุดููู ูุฌูุฉ ุงูุณูุงูุฉ',cat:'DEC',url:'https://drive.google.com/open?id=1KJcIqUbXfHIH0qt1UwoJ0Dohc_7n-745rhx90shaqNg'},
  {code:'PLN-FMS-2025-004',name:'ุฎุทุฉ ุงูุทูุงุฑุฆ ูุงูุฅุฎูุงุก',cat:'PLN',url:'https://drive.google.com/open?id=1rPIuA5g52gQSroaaxznZ_SQNOj1TjEDuZ9DF0j3jvf4'},
  {code:'PLN-FMS-2025-007',name:'ุฎุทุฉ ุฅุฏุงุฑุฉ ุงูููุงูุงุช',cat:'PLN',url:'https://drive.google.com/open?id=1iSoFBh8u4uTHzDJECxyjlEMeWqaScZwezgOXygEVdso'},
  {code:'PLN-FMS-2025-012',name:'ุฎุทุฉ ุฅุฏุงุฑุฉ ุงูุทุงูุฉ ูุงูููุงู',cat:'PLN',url:'https://drive.google.com/open?id=1b8oP_LOE_k7A0qXqhhVKWXF9zAvJMuSUOLFc1rBoflA'},
  {code:'PLN-FMS-2025-016',name:'ุฎุทุฉ ุงูุตูุงูุฉ ุงูุทุงุฑุฆุฉ',cat:'PLN',url:'https://drive.google.com/open?id=1tQYPW6VHtr1liM7qMoPGgzDxopw9njYivS7WyKxokZw'},
  {code:'PLN-FMS-2025-018',name:'ุฎุทุฉ ุงูุฃูู ุงููุงุฏู ูููุฑุงูู',cat:'PLN',url:'https://drive.google.com/open?id=1aF0KTinNcF3gMIotj_byzrAkubX6Y30nZWmVuFM7BcA'},
  {code:'TRN-FMS-2025-010',name:'ุฎุทุฉ ุชุฏุฑูุจ ุงูุฃูู ูุงูุณูุงูุฉ',cat:'TRN',url:'https://drive.google.com/open?id=1IwnBiZp11BjIDQLUtT5Ntr7kEhv3jmssvF5Vj6D7yRk'},
  {code:'LOG-FMS-2025-005',name:'ุณุฌู ุงูุตูุงูุฉ ุงูููุงุฆูุฉ',cat:'LOG',url:'https://drive.google.com/open?id=10QjYYiAppgrOJpb6F2GxxwmRgRt2ooNOClo0etgzWpw'},
  {code:'LOG-FMS-2025-006',name:'ุณุฌู ุงูุญูุงุฏุซ ูุงูููุงุญุธุงุช',cat:'LOG',url:'https://drive.google.com/open?id=12D_ESZYNwjEfKZM6C0yzswbsccugSZZBOcMdHELd3TY'},
  {code:'LOG-FMS-2025-014',name:'ุณุฌู ุฒูุงุฑุงุช ุงูุฏูุงุน ุงููุฏูู ูุงูุฌูุงุช ุงูุชูุธูููุฉ',cat:'LOG',url:'https://drive.google.com/open?id=1VMNxaSlkz_LX4OqktVHQsj1IT-GA6Y3eUnZa2rgegMA'},
  {code:'CHK-FMS-2025-003',name:'ูุงุฆูุฉ ุงูุชุญูู ุงูุฏูุฑูุฉ ููุณูุงูุฉ',cat:'CHK',url:'https://drive.google.com/open?id=1C07oXDzj_Vfok81wQUde3P-ExeXhJh6LDwOS35jTDpk'},
  {code:'CHK-FMS-2025-009',name:'ุณุฌู ุฌููุงุช ูุฌูุฉ ุงูุณูุงูุฉ',cat:'CHK',url:'https://drive.google.com/open?id=1fKMIzns80N9IeSU18WudplOpA8DmbL4zmq72PRUmfZw'},
  {code:'FRM-FMS-2025-011',name:'ูููุฐุฌ ุชูููู ุงููุฎุงุทุฑ ุงูุจูุฆูุฉ ูุงููุงุฏูุฉ',cat:'FRM',url:'https://drive.google.com/open?id=15uefBzxMrX33-lBCHP3sZb_OZqoQ4hyiymQRnBrN_jo'},
  {code:'FRM-FMS-2025-017',name:'ูููุฐุฌ ูุชุงุจุนุฉ ุชูููุฐ ุงูุชูุตูุงุช',cat:'FRM',url:'https://drive.google.com/open?id=1Z7Bof_s4Dchx3G5tPzHAC77M4EDVGaxKVRlvJG_wMNY'},
  {code:'REP-FMS-2025-008',name:'ุชูุฑูุฑ ูุญุต ุงูุทูุงูุงุช ูุฃูุธูุฉ ุงูุฅูุฐุงุฑ',cat:'REP',url:'https://drive.google.com/open?id=1Doz1piFf3dnYXKYtWoV4ExjXG_gmgRLVXkP7ej0sw9E'},
  {code:'REP-FMS-2025-013',name:'ุชูุฑูุฑ ุงูุญูุงุฏุซ ุงูุทุงุฑุฆุฉ',cat:'REP',url:'https://drive.google.com/open?id=126D1IVGQpoCUxXZeNlob1fBD0LkXeNQdITDzL5OLXn0'},
  {code:'FMS_Docs_2025_endorsed',name:'ููุฑุณ ูุซุงุฆู FMS ุงููุนุชูุฏุฉ 2025',cat:'IDX',url:'https://drive.google.com/open?id=1fTJG9dYRDsgBo0UFSKWlOIkVLkKCY0zO'}
];
const FMS_ORDER = ['POL','SOP','DEC','PLN','TRN','LOG','CHK','FRM','REP','IDX'];
const FMS_CATN = {POL:'ุงูุณูุงุณุงุช',SOP:'ุฅุฌุฑุงุกุงุช ุงูุชุดุบูู',DEC:'ุงููุฑุงุฑุงุช',PLN:'ุงูุฎุทุท',TRN:'ุงูุชุฏุฑูุจ',LOG:'ุงูุณุฌูุงุช',CHK:'ููุงุฆู ุงูุชุญูู',FRM:'ุงูููุงุฐุฌ',REP:'ุงูุชูุงุฑูุฑ',IDX:'ููุฑุณ'};
let fmsActive='POL';
function renderFmsTabs(){
  const tabs=document.getElementById('fmsTabs'); tabs.innerHTML='';
  FMS_ORDER.forEach(c=>{
    const count=FMS_DOCS.filter(d=>d.cat===c).length;
    const b=document.createElement('button'); b.className='tab'+(fmsActive===c?' active':'');
    b.textContent=(FMS_CATN[c]||c)+' ('+count+')'; b.onclick=()=>{fmsActive=c; renderFms();};
    tabs.appendChild(b);
  });
}
function renderFms(){
  renderFmsTabs();
  const grid=document.getElementById('fmsGrid'); grid.innerHTML='';
  const q = (document.getElementById('fmsSearch').value||'').trim().toLowerCase();
  FMS_DOCS.filter(d=>d.cat===fmsActive).filter(d=>!q||d.code.toLowerCase().includes(q)||d.name.toLowerCase().includes(q)).forEach(d=>{
    const c=document.createElement('div'); c.className='doc-card';
    c.innerHTML = `
      <div class="doc-code">${d.code}</div>
      <div class="text-gray-700">${d.name}</div>
      <div class="flex gap-2 mt-auto">
        <button class="bg-[var(--maroon)] text-white px-3 py-2 rounded" onclick="openDoc('${d.code}','${d.url}')">ุนุฑุถ</button>
        <a class="px-3 py-2 rounded border text-[var(--maroon)]" target="_blank" href="${d.url}">โ ูุชุญ</a>
      </div>`;
    grid.appendChild(c);
  });
}
document.getElementById('fmsSearch').addEventListener('input',renderFms);
renderFms();

/* ===== ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ: ุฑูุงุจุท ูุฑุชุจุฉ ููุฆุงุช ูููุฉ ===== */
const RM_DOCS = [
  // ูุฑุงุฑุงุช ูุจุฑูุงูุฌ
  {cat:'ูุฑุงุฑุงุช ูุจุฑูุงูุฌ', code:'LD.31', name:'ูุฑุงุฑ ุงุนุชูุงุฏ ุจุฑูุงูุฌ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ (LD.31)', url:'https://drive.google.com/open?id=1TYH87_v6rC2twWOZig2P5YDegRv6ir2dlYEU-v6KXwg'},
  {cat:'ูุฑุงุฑุงุช ูุจุฑูุงูุฌ', code:'LD.32', name:'ูุฑุงุฑ ุฅุฏุงุฑู ุงุนุชูุงุฏ ุณูุงุณุฉ ุงูุฅุจูุงุบ (LD.32)', url:'https://drive.google.com/open?id=1irNRM1ovqwQEaEEj5gv9rmAuoV8O5aY-m0hSNykZDUk'},
  {cat:'ูุฑุงุฑุงุช ูุจุฑูุงูุฌ', code:'LD31/32-Comm', name:'ูุฑุงุฑ ุชุดููู ูุฌูุฉ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ ูุณูุงูุฉ ุงููุฑุถู', url:'https://drive.google.com/open?id=1yN0wiHu-mmNqFHF5XeEQIqOeMElIFSXn-xCz1AzAfco'},
  // ููุงุฐุฌ ุงูุจูุงุบ
  {cat:'ููุงุฐุฌ ุงูุจูุงุบ', code:'IR',  name:'ูููุฐุฌ ุจูุงุบ ุญุงุฏุซ (Incident Report)', url:'https://drive.google.com/open?id=1rFQjcCWP010zLNb4FfRtT1aTmrbY9fyjGcMeYIXSQqQ'},
  {cat:'ููุงุฐุฌ ุงูุจูุงุบ', code:'NM',  name:'ูููุฐุฌ ุจูุงุบ ูุฑูุจ ูู ุงููููุน (Near Miss)', url:'https://drive.google.com/open?id=1DhGR9WtVrM2LxITiv8WBMSCKs407Kb-vUZXg0mZVwD0'},
  {cat:'ููุงุฐุฌ ุงูุจูุงุบ', code:'SE',  name:'ูููุฐุฌ ุฅุฎุทุงุฑ ุญุฏุซ ุฌุณูู (Sentinel Event)', url:'https://drive.google.com/open?id=1LrOlWxfECxyzF77DnerV15RjS-ElSTbIEa1UuKG3rD0'},
  {cat:'ููุงุฐุฌ ุงูุจูุงุบ', code:'UNSAFE', name:'ูููุฐุฌ ุจูุงุบ ุฎุทุฑ/ุดุฑุท ุบูุฑ ุขูู', url:'https://drive.google.com/open?id=1Yw7CFRvzssAWU0JYFkNz1Z9o0fQoMKCqoqrRhEHWZ_I'},
  {cat:'ููุงุฐุฌ ุงูุจูุงุบ', code:'EQ-BR', name:'ูููุฐุฌ ุจูุงุบ ุนุทู ุฌูุงุฒ/ุชุฌููุฒ', url:'https://drive.google.com/open?id=17tZnAvhWCvPbb5Bp3UymLxzEz-IciEjxV4Tn97tIWwQ'},
  // ุฃุฏูุงุช ูุชุญููู
  {cat:'ุฃุฏูุงุช ูุชุญููู', code:'RCA/CAP', name:'ูููุฐุฌ RCA/CAP (ุชุญููู ุงูุณุจุจ ุงูุฌุฐุฑู ูุฎุทุฉ ุงูุฅุฌุฑุงุก ุงูุชุตุญูุญู)', url:'https://drive.google.com/open?id=1lDKsjgPDCdwXNV935kB_DfAm-ZsdzLPK8p4Pn7hgJJ0'},
  {cat:'ุฃุฏูุงุช ูุชุญููู', code:'HFMEA', name:'ูุฑูุฉ ุนูู HFMEA (ุชุญููู ููุท ุงููุดู ูุชุฃุซูุฑู ุนุงูู ุงูุฎุทูุฑุฉ)', url:'https://drive.google.com/open?id=15ZjKLJYhe3HCUWbAO2Iw96IY1GOn1VNCWIjzdi9U4x8'},
  // ููุญุงุช ููุคุดุฑุงุช
  {cat:'ููุญุงุช ููุคุดุฑุงุช', code:'KPI-Board', name:'ููุญุฉ ุงููุคุดุฑุงุช ุงูุดูุฑูุฉ', url:'https://drive.google.com/open?id=1pj8P8rf4TZj_wVKgLrO8ayP9WNUBc1yTWeAy8r0xGOY'},
  {cat:'ููุญุงุช ููุคุดุฑุงุช', code:'Escalation', name:'ููุญุฉ ุงูุงุชุตุงูุงุช ูุณูุณูุฉ ุงูุชุตุนูุฏ', url:'https://drive.google.com/open?id=1dZrkUB_d1XblN3QonWxPt9F1LQ6xQIbyNFT4ixI2m64'},
  {cat:'ููุญุงุช ููุคุดุฑุงุช', code:'RM-Dashboard', name:'ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ โ ุนุฑุถ ุงููุดุงูู ูุฎุทุฉ ุงูุญููู', url:'https://drive.google.com/open?id=1ZUBOoQgVbf41pcBxmU5iyoJzddd9e8JJDJ1Z2dekLfY'},
  // ุณุฌููุงุช
  {cat:'ุณุฌููุงุช', code:'Org-Risk-Register', name:'ุณุฌูู ุงููุฎุงุทุฑ ุงููุคุณุณู', url:'https://drive.google.com/open?id=1XVMRWRZKoTpmXPzrPdXJA7PWf9r88YwLYv_tptdiZAA'},
  // ุชุฏุฑูุจ
  {cat:'ุชุฏุฑูุจ', code:'Training-Att', name:'ูููุฐุฌ ุญุถูุฑ ุชุฏุฑูุจ (ูุฑูู)', url:'https://drive.google.com/open?id=1GIOUPLH9AzWB0PKZiaV_NJoQwjkbzZLyaPkoaV1niC8'},
  // ูุตูุต ูุนูุงุฑ (ููุฑุฌูุน)
  {cat:'ูุฑุฌุน ูุนูุงุฑู', code:'LD31-Text', name:'ูุณุชูุฏ ูุฑุฌุนู โ LD31', url:'https://drive.google.com/open?id=1AEtBJgibYuSxVD_bSZgAlFgODnadZcDMTZaKle3pnYg'},
  {cat:'ูุฑุฌุน ูุนูุงุฑู', code:'LD32-Text', name:'ูุณุชูุฏ ูุฑุฌุนู โ LD32', url:'https://drive.google.com/open?id=1x6R5DKODJ1MKghpPEnaR-1GIohAEILzmY6VNgAPgzAE'}
];
const RM_ORDER = ['ูุฑุงุฑุงุช ูุจุฑูุงูุฌ','ููุงุฐุฌ ุงูุจูุงุบ','ุฃุฏูุงุช ูุชุญููู','ููุญุงุช ููุคุดุฑุงุช','ุณุฌููุงุช','ุชุฏุฑูุจ','ูุฑุฌุน ูุนูุงุฑู'];
let rmActive='ูุฑุงุฑุงุช ูุจุฑูุงูุฌ';
function renderRmTabs(){
  const tabs=document.getElementById('rmTabs'); tabs.innerHTML='';
  RM_ORDER.forEach(c=>{
    const count=RM_DOCS.filter(d=>d.cat===c).length;
    const b=document.createElement('button'); b.className='tab'+(rmActive===c?' active':'');
    b.textContent=c+' ('+count+')'; b.onclick=()=>{rmActive=c; renderRm();};
    tabs.appendChild(b);
  });
}
function renderRm(){
  renderRmTabs();
  const grid=document.getElementById('rmGrid'); grid.innerHTML='';
  RM_DOCS.filter(d=>d.cat===rmActive).forEach(d=>{
    const c=document.createElement('div'); c.className='doc-card';
    c.innerHTML=`
      <div class="doc-code">${d.code}</div>
      <div class="text-gray-700">${d.name}</div>
      <div class="flex gap-2 mt-auto">
        <button class="bg-[var(--maroon)] text-white px-3 py-2 rounded" onclick="openDoc('${d.code}','${d.url}')">ุนุฑุถ</button>
        <a class="px-3 py-2 rounded border text-[var(--maroon)]" target="_blank" href="${d.url}">โ ูุชุญ</a>
      </div>`;
    grid.appendChild(c);
  });
}
renderRm();

/* ===== Google Apps Script: ูููุฐุฌ ุงูุฌููุงุช + ุชุณุฌูู ุงูุญุถูุฑ ===== */
const FMS_API_URL = 'YOUR_GOOGLE_SCRIPT_WEB_APP_URL_HERE';   // ุฌููุงุช ุงูุณูุงูุฉ -> Google Sheet
const TRAINING_API_URL = 'YOUR_TRAINING_WEB_APP_URL_HERE';   // ุชุณุฌูู ุญุถูุฑ ูุชุฏุฑุจ -> Google Sheet

document.getElementById('roundForm').addEventListener('submit', async (e)=>{
  e.preventDefault(); const msg = document.getElementById('roundMsg'); msg.textContent='ุฌุงุฑู ุงูุฅุฑุณุงู...';
  try{
    if(!FMS_API_URL || FMS_API_URL.includes('YOUR_GOOGLE_SCRIPT')) throw new Error('API URL not set');
    const data = new FormData(e.target); const res = await fetch(FMS_API_URL, {method:'POST', body:data});
    if(res.ok || res.type==='opaque'){ msg.textContent='โ ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ ุฅูู Google Sheet'; e.target.reset(); }
    else { msg.textContent='โ๏ธ ูู ูุชู ุงูุฅุฑุณุงู โ ุชุฃูุฏ ูู ุตูุงุญูุงุช Web App'; }
  }catch(err){ msg.textContent='โ ุฎุทุฃ ูู ุงูุงุชุตุงู โ ุญุฏูุซ ุฑุงุจุท Web App ูุชุญูู ูู CORS/ุงูุฃุฐููุงุช'; }
});

document.getElementById('trainingForm').addEventListener('submit', async (e)=>{
  e.preventDefault(); const msg = document.getElementById('trainingMsg'); msg.textContent='ุฌุงุฑู ุงูุญูุธ...';
  try{
    if(!TRAINING_API_URL || TRAINING_API_URL.includes('YOUR_TRAINING')) throw new Error('TRAINING URL not set');
    const data = new FormData(e.target); const res = await fetch(TRAINING_API_URL,{method:'POST',body:data});
    if(res.ok || res.type==='opaque'){ msg.textContent='โ ุชู ุญูุธ ุญุถูุฑ ุงููุชุฏุฑุจ'; e.target.reset(); }
    else { msg.textContent='โ๏ธ ูู ูุชู ุงูุญูุธ โ ุชุฃูุฏ ูู ุตูุงุญูุงุช Web App'; }
  }catch(err){ msg.textContent='โ ุฎุทุฃ ูู ุงูุงุชุตุงู โ ุญุฏูุซ ุฑุงุจุท Web App'; }
});
</script>
</body>
</html>
