<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø¨ÙˆØ§Ø¨Ø© Ø³Ø¨Ø§Ù‡ÙŠ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© â€“ Ù…Ø¬Ù…Ø¹ Ù…ÙƒØ© Ø§Ù„Ø·Ø¨ÙŠ Ø¨Ø§Ù„Ø²Ø§Ù‡Ø±</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Tajawal', sans-serif; background-color: #f9f9f9; }
    .dark body { background-color: #1a1a1a; color: #eee; }
    .sidebar { width: 270px; background: linear-gradient(180deg, #7B1E24, #C55A44); color: white; }
    .nav-link { display: block; padding: 0.75rem 1rem; border-radius: 0.5rem; transition: all 0.2s; }
    .nav-link:hover { background-color: rgba(255,255,255,0.15); }
    .active-link { background-color: rgba(255,255,255,0.25); }
    .content-section { display: none; }
    .content-section.active { display: block; }
    .org-chart { display: flex; flex-direction: column; align-items: center; }
    .org-level { display: flex; justify-content: center; margin: 20px 0; }
    .org-node { background: white; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 0 10px; text-align: center; width: 200px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .org-node.director { background: #7B1E24; color: white; }
    .org-node.manager { background: #C55A44; color: white; }
    .org-node.head { background: #e9c46a; }
    .committee-card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .committee-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .committee-code { background: #7B1E24; color: white; padding: 5px 10px; border-radius: 4px; font-weight: bold; }
    .committee-members { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; }
    .member-card { background: #f5f5f5; padding: 10px; border-radius: 5px; }
    .member-role { font-weight: bold; color: #7B1E24; }
    .indicator-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
    .indicator-value { font-size: 2rem; font-weight: bold; margin: 10px 0; }
    .progress-bar { height: 10px; background: #e0e0e0; border-radius: 5px; overflow: hidden; margin: 10px 0; }
    .progress-fill { height: 100%; background: #7B1E24; }
    .document-card { background: white; border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <header class="flex justify-between items-center bg-white shadow-md px-6 py-4 sticky top-0 z-50">
    <div class="flex items-center gap-4">
      <div class="flex items-center gap-3">
        <!-- Logo Placeholder - Replace with your actual logo -->
        <div class="h-14 w-14 bg-gradient-to-br from-[#7B1E24] to-[#C55A44] rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg">
          <span class="text-xs text-center">Makkah<br>Polyethnic</span>
        </div>
        <div>
          <h1 class="text-xl font-bold text-gray-800">Ø¨ÙˆØ§Ø¨Ø© Ø³Ø¨Ø§Ù‡ÙŠ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</h1>
          <p class="text-sm text-gray-500">Makkah Polyethnic â€“ Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2025</p>
        </div>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <button id="darkModeBtn" class="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition duration-200">
        <i class="fas fa-moon ml-1"></i>
        ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ
      </button>
      <button onclick="window.print()" class="px-4 py-2 bg-[#7B1E24] text-white rounded-lg hover:bg-[#8f2b33] transition duration-200">
        <i class="fas fa-print ml-1"></i>
        Ø·Ø¨Ø§Ø¹Ø© / PDF
      </button>
    </div>
  </header>

  <div class="flex flex-1">
    <aside class="sidebar p-4 text-sm leading-relaxed">
      <div class="font-bold mb-3 text-lg">ğŸ“š Ø£Ù‚Ø³Ø§Ù… Ø¨ÙˆØ§Ø¨Ø© Ø³Ø¨Ø§Ù‡ÙŠ</div>
      <a href="#home" class="nav-link active-link" onclick="showSection('home')">ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <div class="font-bold mt-4 mb-2">ğŸ›ï¸ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ù„Ø­ÙˆÙƒÙ…Ø© (LD)</div>
      <a href="#leadership" class="nav-link" onclick="showSection('leadership')">Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ ÙˆØ§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</a>
      <a href="#organizational-structure" class="nav-link" onclick="showSection('organizational-structure')">Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</a>
      <a href="#committees" class="nav-link" onclick="showSection('committees')">Ø§Ù„Ù„Ø¬Ø§Ù† Ø§Ù„Ø±Ø³Ù…ÙŠØ©</a>
      <a href="#key-indicators" class="nav-link" onclick="showSection('key-indicators')">Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</a>
      <div class="font-bold mt-4 mb-2">ğŸ› ï¸ Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„Ù…Ø±Ø§ÙÙ‚ (FMS)</div>
      <a href="#fms-workspace" class="nav-link" onclick="showSection('fms-workspace')">Ù…Ø³Ø§Ø­Ø© Ø¹Ù…Ù„ FMS</a>
      <a href="#dashboard" class="nav-link" onclick="showSection('dashboard')">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª</a>
      <a href="#plans" class="nav-link" onclick="showSection('plans')">Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ø«Ù…Ø§Ù†ÙŠØ©</a>
      <a href="#forms" class="nav-link" onclick="showSection('forms')">Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª</a>
      <div class="font-bold mt-4 mb-2">ğŸ“ˆ Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙ…Ø± (QI)</div>
      <a href="#qi" class="nav-link" onclick="showSection('qi')">Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©</a>
      <div class="font-bold mt-4 mb-2">âš ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± (RM)</div>
      <a href="#rm" class="nav-link" onclick="showSection('rm')">Ù†Ù…Ø§Ø°Ø¬ ÙˆØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±</a>
      <div class="font-bold mt-4 mb-2">ğŸ§« Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰ (IPC)</div>
      <a href="#ipc" class="nav-link" onclick="showSection('ipc')">Ø§Ù„Ø®Ø·Ø· ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª</a>
      <div class="font-bold mt-4 mb-2">â¤ï¸â€ğŸ©¹ Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰ (PSC)</div>
      <a href="#psc" class="nav-link" onclick="showSection('psc')">Ø³ÙŠØ§Ø³Ø§Øª ÙˆÙ†Ù…Ø§Ø°Ø¬ Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰</a>
      <div class="font-bold mt-4 mb-2">ğŸš¨ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ ÙˆØ§Ù„ÙƒÙˆØ§Ø±Ø« (EOC)</div>
      <a href="#eoc" class="nav-link" onclick="showSection('eoc')">Ø§Ù„Ø®Ø·Ø· ÙˆØ§Ù„Ø¥Ø®Ù„Ø§Ø¡</a>
      <div class="font-bold mt-4 mb-2">ğŸ—‚ï¸ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯Ø§Øª</div>
      <a href="#reports" class="nav-link" onclick="showSection('reports')">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠØ©</a>
      <a href="#accreditation" class="nav-link" onclick="showSection('accreditation')">Ù…Ù„ÙØ§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</a>
    </aside>

    <main class="flex-1 p-6 overflow-y-auto" id="mainContent">
      <section id="home" class="content-section active">
        <div class="flex flex-col items-center justify-center h-full mt-10">
          <!-- Updated Logo -->
          <div class="h-40 w-40 bg-gradient-to-br from-[#7B1E24] to-[#C55A44] rounded-full flex items-center justify-center text-white text-4xl font-bold mb-6 shadow-xl">
            <span class="text-lg text-center">Makkah<br>Polyethnic</span>
          </div>
          <h2 class="text-3xl font-bold text-[#7B1E24] mb-3">CBAHI Electronic Portal</h2>
          <p class="text-gray-600 text-lg mb-2">Makkah Polyethnic â€“ Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2025</p>
          <p class="text-sm text-gray-400 mb-8">Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø±Ø³Ù…ÙŠ 2025 â€“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-4xl">
            <div class="bg-white p-6 rounded-lg shadow-md border hover:shadow-lg transition duration-300">
              <i class="fas fa-chart-line text-3xl text-[#7B1E24] mb-3"></i>
              <h3 class="font-bold text-lg mb-2">Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø­ÙŠÙˆÙŠØ©</h3>
              <p class="text-gray-600">Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md border hover:shadow-lg transition duration-300">
              <i class="fas fa-file-alt text-3xl text-[#7B1E24] mb-3"></i>
              <h3 class="font-bold text-lg mb-2">Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª</h3>
              <p class="text-gray-600">Ø¬Ù…ÙŠØ¹ ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md border hover:shadow-lg transition duration-300">
              <i class="fas fa-chart-bar text-3xl text-[#7B1E24] mb-3"></i>
              <h3 class="font-bold text-lg mb-2">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</h3>
              <p class="text-gray-600">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Other sections remain the same as in your original code -->
      <!-- ... -->

      <!-- FMS Workspace Section - Updated with your documents -->
      <section id="fms-workspace" class="content-section">
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-2xl font-bold text-[#7B1E24]">ğŸ› ï¸ Ù…Ø³Ø§Ø­Ø© Ø¹Ù…Ù„ FMS (Ù…ØªØ·Ù„Ø¨Ø§Øª Ø³Ø¨Ø§Ù‡ÙŠ)</h2>
            <div class="flex gap-2">
              <button onclick="window.print()" class="px-3 py-2 text-sm bg-[#7B1E24] text-white rounded-lg hover:bg-[#8f2b33]">
                ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©
              </button>
            </div>
          </div>
          <div class="border-b border-gray-200 mb-4 flex flex-wrap gap-2">
            <button class="px-3 py-2 text-sm rounded bg-[#7B1E24] text-white" data-fms-tab="needs" onclick="switchFmsTab('needs')">âœ… Ø¨Ø§Ù†ÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª</button>
            <button class="px-3 py-2 text-sm rounded bg-gray-100 hover:bg-gray-200" data-fms-tab="plans" onclick="switchFmsTab('plans')">ğŸ“ Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ø«Ù…Ø§Ù†ÙŠØ©</button>
            <button class="px-3 py-2 text-sm rounded bg-gray-100 hover:bg-gray-200" data-fms-tab="governance" onclick="switchFmsTab('governance')">ğŸ›ï¸ Ø§Ù„Ø­ÙˆÙƒÙ…Ø© ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª</button>
            <button class="px-3 py-2 text-sm rounded bg-gray-100 hover:bg-gray-200" data-fms-tab="forms" onclick="switchFmsTab('forms')">ğŸ—‚ï¸ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª</button>
            <button class="px-3 py-2 text-sm rounded bg-gray-100 hover:bg-gray-200" data-fms-tab="kpis" onclick="switchFmsTab('kpis')">ğŸ“Š Ù…Ø¤Ø´Ø±Ø§Øª FMS</button>
          </div>
          <div id="fmsTabContent" class="space-y-4">
            <!-- Content will be dynamically loaded here -->
          </div>
        </div>
      </section>

      <!-- FMS Modal for document viewing -->
      <div id="fmsModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
        <div class="bg-white w-[95vw] max-w-4xl rounded-lg shadow-xl overflow-hidden">
          <div class="flex items-center justify-between px-4 py-3 border-b">
            <h3 id="fmsModalTitle" class="font-bold text-lg">Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</h3>
            <button onclick="closeFmsModal()" class="text-gray-600 hover:text-gray-900">âœ•</button>
          </div>
          <div class="p-0">
            <iframe id="fmsModalFrame" class="w-full h-[70vh]" src="about:blank"></iframe>
          </div>
          <div class="flex items-center justify-between px-4 py-3 border-t bg-gray-50">
            <a id="fmsModalOpenNew" href="#" target="_blank" class="text-[#7B1E24] underline">ÙØªØ­ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯</a>
            <button onclick="closeFmsModal()" class="px-3 py-2 bg-gray-200 rounded hover:bg-gray-300">Ø¥ØºÙ„Ø§Ù‚</button>
          </div>
        </div>
      </div>

      <!-- Other sections remain the same -->
      <!-- ... -->

    </main>
  </div>

  <footer class="bg-[#7B1E24] text-white text-center py-3 text-sm">
    Â© 2025 Makkah Polyethnic â€“ Ø¨ÙˆØ§Ø¨Ø© Ø³Ø¨Ø§Ù‡ÙŠ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©
  </footer>

  <script>
    // ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© Ù„Ù…Ø³Ø§Ø­Ø© FMS =====
    const FMS_API_URL = 'YOUR_GOOGLE_SCRIPT_URL_HERE'; // Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ù„ØªÙƒØ§Ù…Ù„ Ù„Ø§Ø­Ù‚Ø§Ù‹
    
    // Ø®Ø±Ø§Ø¦Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ù„Ù FMS_Ø§Ù„Ù…Ø¬Ù…Ø¹_ÙƒÙ„_Ø§Ù„ÙˆØ«Ø§ÙŠÙ”Ù‚.md)
    const FMS_PLANS = [
      {code:'FMS-P01', name:'Ø®Ø·Ø© Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø¨Ù†Ù‰ (Safety of the Building)', url:'about:blank'},
      {code:'FMS-P02', name:'Ø®Ø·Ø© Ø§Ù„Ø£Ù…Ù† (Security Plan)', url:'about:blank'},
      {code:'FMS-P03', name:'Ø®Ø·Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø®Ø·Ø±Ø© ÙˆØ§Ù„ØªØ®Ù„Øµ Ù…Ù† Ø§Ù„Ù†ÙØ§ÙŠØ§Øª', url:'about:blank'},
      {code:'FMS-P04', name:'Ø®Ø·Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© (Internal Emergency Plan)', url:'about:blank'},
      {code:'FMS-P05', name:'Ø®Ø·Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© (External Emergency Plan)', url:'about:blank'},
      {code:'FMS-P06', name:'Ø®Ø·Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ù…Ù† Ø§Ù„Ø­Ø±Ø§Ø¦Ù‚ (Fire Safety Program)', url:'about:blank'},
      {code:'FMS-P07', name:'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø·Ø¨ÙŠØ© (Medical Equipment Management Plan)', url:'about:blank'},
      {code:'FMS-P08', name:'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø±Ø§ÙÙ‚ (Utilities Management Plan)', url:'about:blank'},
    ];

    const FMS_GOV = [
      {code:'FMS-G01', name:'Ù…ÙŠØ«Ø§Ù‚ Ù„Ø¬Ù†Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø§ÙÙ‚ (FMS Committee Charter)', url:'about:blank'},
      {code:'FMS-G02', name:'Ø§Ù„ÙˆØµÙ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ ÙˆÙ…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª Ù…Ø¯ÙŠØ± Ø¨Ø±Ù†Ø§Ù…Ø¬ FMS', url:'about:blank'},
      {code:'FMS-G03', name:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¬ÙˆÙ„Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ© ÙˆØ³Ø¬Ù„ Ø¬ÙˆÙ„Ø§Øª Ø§Ù„Ø³Ù„Ø§Ù…Ø©', url:'about:blank'},
      {code:'FMS-G04', name:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ© PPM ÙˆØ®Ø·Ø© Ø³Ù†ÙˆÙŠØ©', url:'about:blank'},
      {code:'FMS-G05', name:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', url:'about:blank'},
      {code:'FMS-G06', name:'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø®Ù„Ø§Ù„ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¨Ù†Ø§Ø¡/Ø§Ù„ØªØ¬Ø¯ÙŠØ¯/Ø§Ù„Ù‡Ø¯Ù…', url:'about:blank'},
      {code:'FMS-G07', name:'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± (HVA/FMEA) Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø±Ø§ÙÙ‚', url:'about:blank'},
      {code:'FMS-G08', name:'Ø®Ø·Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„ØªÙˆØ¹ÙŠØ© ÙˆØ§Ù„ØªÙˆØ¬ÙŠÙ‡ ÙÙŠ FMS', url:'about:blank'},
      {code:'FMS-G09', name:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ù„Ù„Ø·ÙˆØ§Ø±Ø¦ ÙˆØ§Ù„Ø¥Ø®Ù„Ø§Ø¡', url:'about:blank'},
      {code:'FMS-G10', name:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­', url:'about:blank'},
      {code:'FMS-G11', name:'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØºØ§Ø²Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© (Ø¥Ù† ÙˆØ¬Ø¯Øª)', url:'about:blank'},
    ];

    const FMS_FORMS = [
      {code:'F-01', name:'Ù†Ù…ÙˆØ°Ø¬ Ø¬ÙˆÙ„Ø© Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø±ÙÙ‚ (Facility Safety Tour Checklist)', url:'about:blank'},
      {code:'F-02', name:'Ø³Ø¬Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¥Ù†Ø°Ø§Ø± Ù…Ù† Ø§Ù„Ø­Ø±ÙŠÙ‚', url:'about:blank'},
      {code:'F-03', name:'Ø³Ø¬Ù„ ØµÙŠØ§Ù†Ø© Ù…Ø¹Ø¯Ø§Øª Ø§Ù„Ø¥Ø·ÙØ§Ø¡', url:'about:blank'},
      {code:'F-04', name:'Ù†Ù…ÙˆØ°Ø¬ ØªÙ‚Ø±ÙŠØ± ØªÙ…Ø±ÙŠÙ† Ø¥Ø®Ù„Ø§Ø¡ ÙˆÙ…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠÙ† (AAR)', url:'about:blank'},
      {code:'F-05', name:'Ø³Ø¬Ù„ ØµÙŠØ§Ù†Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø·Ø¨ÙŠØ©', url:'about:blank'},
      {code:'F-06', name:'Ø³Ø¬Ù„ Ø§Ù„ØºØ§Ø²Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© ÙˆØ¶ÙˆØ§Ø¨Ø·Ù‡Ø§', url:'about:blank'},
      {code:'F-07', name:'Ø³Ø¬Ù„ ØªØ±Ø§Ø®ÙŠØµ Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±', url:'about:blank'},
      {code:'F-08', name:'Ù‚Ø§Ø¦Ù…Ø© ØªØ­Ù‚Ù‚ Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù„ÙØªØ­ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø§Øª', url:'about:blank'},
      {code:'F-09', name:'Ø³Ø¬Ù„ Ø§Ù„ØªØ®Ù„Øµ Ù…Ù† Ø§Ù„Ù†ÙØ§ÙŠØ§Øª Ø§Ù„Ø·Ø¨ÙŠØ© ÙˆØ§Ù„Ø®Ø·Ø±Ø©', url:'about:blank'},
      {code:'F-10', name:'Ø³Ø¬Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù†Ø§Ø±Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ ÙˆÙ…Ø®Ø§Ø±Ø¬ Ø§Ù„Ø®Ø±ÙˆØ¬', url:'about:blank'},
      {code:'F-11', name:'Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙÙŠ ÙƒÙ„ ØºØ±ÙØ©/Ø¹ÙŠØ§Ø¯Ø©', url:'about:blank'},
    ];

    // Ù‚Ø§Ø¦Ù…Ø© Â«Ø¨Ø§Ù†ÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÂ» Ù…Ø³ØªØ®Ø±Ø¬Ø© Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ø¡Ù…Ø© (Map)
    const FMS_NEEDS = [
      {key:'charter', label:'Ù…ÙŠØ«Ø§Ù‚ Ù„Ø¬Ù†Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø§ÙÙ‚ (G01) Ù…Ø¹ØªÙ…Ø¯', required:true},
      {key:'plans8', label:'Ø§Ø¹ØªÙ…Ø§Ø¯ ÙˆØªÙˆÙØ± Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ø«Ù…Ø§Ù†ÙŠØ© (P01â€“P08)', required:true},
      {key:'ppmpolicy', label:'Ø³ÙŠØ§Ø³Ø© PPM + Ø®Ø·Ø© Ø³Ù†ÙˆÙŠØ© Ù…ÙˆÙ‚Ù‘Ø¹Ø© (G04)', required:true},
      {key:'tours', label:'Ø¬ÙˆÙ„Ø§Øª Ø³Ù„Ø§Ù…Ø© Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØ© + Ø³Ø¬Ù„Ø§Øª F-01', required:true},
      {key:'civildef', label:'ØªØ±Ø®ÙŠØµ Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ Ø³Ø§Ø±ÙŠ + Ø³Ø¬Ù„ F-07', required:true},
      {key:'fire', label:'Ø³Ø¬Ù„Ø§Øª Ø¥Ù†Ø°Ø§Ø±/Ø¥Ø·ÙØ§Ø¡/Ø¥Ù†Ø§Ø±Ø© Ø·ÙˆØ§Ø±Ø¦ (F-02/F-03/F-10)', required:true},
      {key:'waste', label:'Ø³Ø¬Ù„ Ø§Ù„ØªØ®Ù„Øµ Ù…Ù† Ø§Ù„Ù†ÙØ§ÙŠØ§Øª Ø§Ù„Ø·Ø¨ÙŠØ©/Ø§Ù„Ø®Ø·Ø±Ø© (F-09)', required:true},
      {key:'medgas', label:'Ø³ÙŠØ§Ø³Ø©/Ø³Ø¬Ù„ Ø§Ù„ØºØ§Ø²Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© (Ø¥Ù† ÙˆØ¬Ø¯Øª) (G11/F-06)', required:false},
      {key:'training', label:'ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ + Ø®Ø·Ø© ØªØ¯Ø±ÙŠØ¨/ØªÙ…Ø§Ø±ÙŠÙ† (G08/G09)', required:true},
      {key:'risk', label:'HVA Ø³Ù†ÙˆÙŠØ© + FMEA Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø±Ø¬Ø© (G07)', required:true},
      {key:'compliance', label:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© (G05)', required:true},
    ];

    // =========== ØªØ¨ÙˆÙŠØ¨Ø§Øª FMS ===========
    function switchFmsTab(tab) {
      document.querySelectorAll('[data-fms-tab]').forEach(btn=>{
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        btn.classList.remove('bg-[#7B1E24]', 'text-white');
        btn.classList.add('bg-gray-100', 'hover:bg-gray-200');
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù†Ø´Ø·Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø­Ø§Ù„ÙŠ
        if (btn.getAttribute('data-fms-tab') === tab) {
          btn.classList.add('bg-[#7B1E24]', 'text-white');
          btn.classList.remove('bg-gray-100', 'hover:bg-gray-200');
        }
      });

      const container = document.getElementById('fmsTabContent');
      container.innerHTML = '';

      if (tab === 'needs') renderNeeds(container);
      if (tab === 'plans') renderList(container, FMS_PLANS, 'Ø®Ø·Ø©/Ø¨Ø±Ù†Ø§Ù…Ø¬');
      if (tab === 'governance') renderList(container, FMS_GOV, 'Ø³ÙŠØ§Ø³Ø©/Ø­ÙˆÙƒÙ…Ø©');
      if (tab === 'forms') renderList(container, FMS_FORMS, 'Ù†Ù…ÙˆØ°Ø¬/Ø³Ø¬Ù„');
      if (tab === 'kpis') renderKpis(container);
    }

    // Â«Ø¨Ø§Ù†ÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÂ»
    function renderNeeds(container) {
      const wrap = document.createElement('div');
      wrap.className = 'grid grid-cols-1 md:grid-cols-2 gap-4';

      FMS_NEEDS.forEach(item=>{
        const card = document.createElement('div');
        card.className = 'p-4 rounded border shadow-sm bg-gray-50';
        card.innerHTML = `
          <div class="flex items-start gap-3">
            <input type="checkbox" id="need_${item.key}" class="mt-1 h-5 w-5" ${item.required ? 'data-required="1"' : ''}>
            <div>
              <label for="need_${item.key}" class="font-semibold">${item.label}</label>
              ${item.required ? '<div class="text-xs text-red-600 mt-1">Ù…Ø·Ù„ÙˆØ¨</div>' : ''}
            </div>
          </div>
        `;
        wrap.appendChild(card);
      });

      const actions = document.createElement('div');
      actions.className = 'flex items-center gap-2 mt-2';
      actions.innerHTML = `
        <button class="px-3 py-2 bg-[#7B1E24] text-white rounded hover:bg-[#8f2b33]" onclick="validateNeeds()">ØªØ­Ù‚Ù‘Ù‚ Ù…Ù† Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„</button>
        <button class="px-3 py-2 bg-gray-200 rounded hover:bg-gray-300" onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø©</button>
      `;

      container.appendChild(wrap);
      container.appendChild(actions);
    }

    function validateNeeds() {
      const required = [...document.querySelectorAll('input[data-required="1"]')];
      const missing = required.filter(cb => !cb.checked);

      if (missing.length === 0) {
        alert('Ù…Ù…ØªØ§Ø² âœ… â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ© Ù…ÙØ¤Ø´Ù‘Ø± Ø¹Ù„ÙŠÙ‡Ø§.');
      } else {
        alert('âš ï¸ Ù‡Ù†Ø§Ùƒ Ø¹Ù†Ø§ØµØ± Ø¥Ù„Ø²Ø§Ù…ÙŠØ© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©: ' + missing.length);
      }
    }

    // Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø®Ø·Ø·/Ø§Ù„Ø­ÙˆÙƒÙ…Ø©/Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
    function renderList(container, items, kind) {
      const list = document.createElement('div');
      list.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4';

      items.forEach(d=>{
        const card = document.createElement('div');
        card.className = 'p-4 rounded border shadow-sm bg-white';
        card.innerHTML = `
          <div class="flex items-center justify-between mb-2">
            <div class="font-bold text-[#7B1E24]">${d.code}</div>
            <span class="text-xs bg-gray-100 px-2 py-1 rounded">${kind}</span>
          </div>
          <div class="mb-3 font-medium">${d.name}</div>
          <div class="flex items-center gap-2">
            <button class="px-3 py-1 text-sm bg-[#7B1E24] text-white rounded hover:bg-[#8f2b33]" onclick="openFmsDoc('${d.code}: ${d.name}', '${d.url}')">ğŸ“„ Ø¹Ø±Ø¶</button>
            <a class="px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300" href="${d.url}" target="_blank">â†— ÙØªØ­ ÙÙŠ ØªØ¨ÙˆÙŠØ¨</a>
          </div>
        `;
        list.appendChild(card);
      });

      // Ø£Ø²Ø±Ø§Ø± Ø¹Ø§Ù…Ø©
      const actions = document.createElement('div');
      actions.className = 'flex items-center gap-2 mt-4';
      actions.innerHTML = `
        <button class="px-3 py-2 bg-gray-200 rounded hover:bg-gray-300" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
      `;

      container.appendChild(list);
      container.appendChild(actions);
    }

    function renderKpis(container) {
      const box = document.createElement('div');
      box.className = 'grid grid-cols-1 md:grid-cols-3 gap-4';
      box.innerHTML = `
        <div class="bg-white p-4 rounded border shadow">
          <div class="text-sm text-gray-500">Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¬ÙˆÙ„Ø§Øª</div>
          <div class="text-2xl font-bold text-[#7B1E24]">85%</div>
        </div>
        <div class="bg-white p-4 rounded border shadow">
          <div class="text-sm text-gray-500">Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ© (PPM)</div>
          <div class="text-2xl font-bold text-[#C55A44]">92%</div>
        </div>
        <div class="bg-white p-4 rounded border shadow">
          <div class="text-sm text-gray-500">Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…Ù†ÙØ°</div>
          <div class="text-2xl font-bold text-[#7B1E24]">78%</div>
        </div>
      `;
      container.appendChild(box);
    }

    // Modal
    function openFmsDoc(title, url) {
      document.getElementById('fmsModalTitle').textContent = title;
      document.getElementById('fmsModalFrame').src = url || 'about:blank';
      document.getElementById('fmsModalOpenNew').href = url || '#';
      document.getElementById('fmsModal').classList.remove('hidden');
      document.getElementById('fmsModal').classList.add('flex');
    }

    function closeFmsModal() {
      document.getElementById('fmsModal').classList.add('hidden');
      document.getElementById('fmsModal').classList.remove('flex');
      document.getElementById('fmsModalFrame').src = 'about:blank';
    }

    // Ø§ÙØªØ­ ØªØ¨ÙˆÙŠØ¨ Â«Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÂ» Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø¯Ø®ÙˆÙ„ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„
    document.addEventListener('DOMContentLoaded', ()=>{
      // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ù†Ø§ Ù†ÙØ¹Ù‘Ù„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø±ØªØ¨Ø· Ù†Ø´Ø·Ø§Ù‹ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
      const activeSection = document.querySelector('.content-section.active');
      if (activeSection && activeSection.id === 'fms-workspace') {
        switchFmsTab('needs');
      }

      // Ø¥Ø¶Ø§ÙØ© Ù…ÙØ±Ø§Ù‚Ø¨ Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ù‚Ø³Ù… Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„ÙŠÙ‡
      document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', (e) => {
          const sectionId = e.target.getAttribute('href').substring(1);
          if (sectionId === 'fms-workspace') {
            // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ø¶Ù…Ø§Ù† ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù…
            setTimeout(() => switchFmsTab('needs'), 50);
          }
        });
      });
    });

    // ===== Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ø§Ù…Ø© =====
    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
    document.getElementById('darkModeBtn').addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
    });

    // Ø¥Ø¯Ø§Ø±Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    function showSection(sectionId) {
      // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
      document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
      document.getElementById(sectionId).classList.add('active');
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù†Ø´Ø·Ø©
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active-link');
      });
      
      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØµØ­ÙŠØ­ Ù„ØªÙØ¹ÙŠÙ„ active-link
      const targetLink = document.querySelector(`.nav-link[href="#${sectionId}"]`);
      if (targetLink) {
        targetLink.classList.add('active-link');
      }
    }

    // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù„Ø¬Ø§Ù†
    function showCommitteeDetails(committeeCode) {
      alert(`Ø³ÙŠØªÙ… ÙØªØ­ ØµÙØ­Ø© ØªÙØµÙŠÙ„ÙŠØ© Ù„Ù„Ø¬Ù†Ø© ${committeeCode} ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©`);
    }

    // Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
    function showDocument(docName) {
      alert(`Ø³ÙŠØªÙ… ÙØªØ­ ÙˆØ«ÙŠÙ‚Ø© ${docName} ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©`);
    }
  </script>
</body>
</html>
