ğŸ“ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù‚ØªØ±Ø­ (Ø§Ù†Ø³Ø®Ù‡ ÙƒÙ…Ø§ Ù‡Ùˆ)
/core
  /rbac
    rbac.js
    permissions-map.js
    guard.js
    bootstrap.js

1ï¸âƒ£ permissions-map.js

Ù…ØµØ¯Ø± ÙˆØ§Ø­Ø¯ Ù„ØªØ¹Ø±ÙŠÙ ÙƒÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

// core/rbac/permissions-map.js

export const PERMISSIONS = {
  dashboard: 'dashboard',
  eoc: 'eoc',
  complaints: 'complaints',
  incidents: 'incidents',
  risks: 'risks',
  rounds: 'rounds',
  calibration: 'calibration',
  maintenance: 'maintenance',
  needlestick: 'needlestick',
  insurance: 'insurance'
};


â— Ù„Ø§ ØªÙƒØªØ¨ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø±
â— Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù‡Ùˆ Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ÙˆØ­ÙŠØ¯

2ï¸âƒ£ rbac.js

Ù…Ø­Ø±Ùƒ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ

// core/rbac/rbac.js

export class RBAC {
  constructor(userData) {
    this.role = userData.role;
    this.permissions = userData.permissions || {};
  }

  // ğŸ‘‘ Ø§Ù„Ù…Ø§Ù„Ùƒ = ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø·Ù„Ù‚Ø©
  isOwner() {
    return this.role === 'owner';
  }

  isAdmin() {
    return this.role === 'admin';
  }

  can(permissionKey) {
    if (this.isOwner()) return true;
    return this.permissions[permissionKey] === true;
  }

  /**
   * Ø¥Ø®ÙØ§Ø¡ Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
   * Ø£ÙŠ Ø¹Ù†ØµØ± ÙŠØ­ØªÙˆÙŠ data-permission Ø³ÙŠØªÙ… Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠÙ‡
   */
  applyUI() {
    if (this.isOwner()) return;

    document.querySelectorAll('[data-permission]').forEach(el => {
      const key = el.dataset.permission;
      if (!this.can(key)) {
        el.remove();
      }
    });
  }

  /**
   * Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
   */
  guardPage(permissionKey) {
    if (!this.can(permissionKey)) {
      window.location.href = 'access-denied.html';
    }
  }
}

3ï¸âƒ£ guard.js

Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø§Øª (ØªØ³ØªØ®Ø¯Ù…Ù‡ ÙÙŠ ÙƒÙ„ ØµÙØ­Ø© Ù†Ø¸Ø§Ù…)

// core/rbac/guard.js

import { RBAC } from './rbac.js';

/**
 * Ø§Ø³ØªØ¯Ø¹Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
 */
export function guardSystemPage(userData, permissionKey) {
  const rbac = new RBAC(userData);
  rbac.guardPage(permissionKey);
}

4ï¸âƒ£ bootstrap.js

ÙŠÙØ³ØªØ¯Ø¹Ù‰ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„

// core/rbac/bootstrap.js

import { RBAC } from './rbac.js';

/**
 * ØªÙ‡ÙŠØ¦Ø© RBAC Ø¨Ø¹Ø¯ Ø¬Ù„Ø¨ userData Ù…Ù† Firestore
 */
export function initRBAC(userData) {
  const rbac = new RBAC(userData);
  rbac.applyUI();
  return rbac;
}

5ï¸âƒ£ ÙƒÙŠÙ ØªØ¯Ù…Ø¬Ù‡ ÙÙŠ Dashboard (Ù…Ù‡Ù… Ø¬Ø¯Ù‹Ø§)
Ø¨Ø¹Ø¯ getUserRole(user.uid) Ù…Ø¨Ø§Ø´Ø±Ø©
import { initRBAC } from './core/rbac/bootstrap.js';

const userData = await getUserRole(user.uid);

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
const rbac = initRBAC(userData);


ğŸ‘† Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙˆØ­Ø¯Ù‡:

ÙŠØ®ÙÙŠ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø±

ÙŠØ®ÙÙŠ KPI

ÙŠØ®ÙÙŠ Ø§Ù„Ø£Ø²Ø±Ø§Ø±

ÙŠØ­ØªØ±Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§

6ï¸âƒ£ ÙƒÙŠÙ ØªØ±Ø¨Ø· Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (HTML)
Sidebar
<a class="nav-item" data-permission="complaints">Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</a>
<a class="nav-item" data-permission="insurance">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ£Ù…ÙŠÙ†</a>
<a class="nav-item" data-permission="maintenance">Ø§Ù„ØµÙŠØ§Ù†Ø©</a>

KPI
<div class="kpi-card" data-permission="rounds"></div>

Ø²Ø±
<button data-permission="incidents">Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ø¯Ø«Ø©</button>


â— Ø£ÙŠ Ø¹Ù†ØµØ± Ø¨Ø¯ÙˆÙ† data-permission = Ù…ØªØ§Ø­ Ù„Ù„Ø¬Ù…ÙŠØ¹

7ï¸âƒ£ Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø§Øª (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ø£Ù…Ù†ÙŠÙ‹Ø§)

ÙÙŠ Ø£Ø¹Ù„Ù‰ ÙƒÙ„ ØµÙØ­Ø© Ù†Ø¸Ø§Ù… (Ø¨Ø¹Ø¯ Ø¬Ù„Ø¨ userData):

import { guardSystemPage } from './core/rbac/guard.js';

guardSystemPage(userData, 'insurance');


Ø£Ù…Ø«Ù„Ø©:

Ø§Ù„ØµÙØ­Ø©	permission
insurance-check.html	insurance
risk-register.html	risks
Round.html	rounds
calibration.html	calibration
maintenance.html	maintenance
eoc-command.html	eoc
8ï¸âƒ£ Ù…Ù†Ø·Ù‚ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù†Ù‡Ø§Ø¦ÙŠ)
if (userData.role === 'owner') {
  window.location.href = 'owner-dashboard.html';
} else if (userData.role === 'admin') {
  window.location.href = 'admin-dashboard.html';
} else {
  window.location.href = 'staff-dashboard.html';
}


âŒ Ù„Ø§ if email
âŒ Ù„Ø§ localStorage
âŒ Ù„Ø§ claims

9ï¸âƒ£ Ù…Ø§Ø°Ø§ ØªØ­Ø°Ù Ø§Ù„Ø¢Ù† (Ø¶Ø±ÙˆØ±ÙŠ)

âŒ allowedSystems
âŒ isTrialPeriod
âŒ developerEmail
âŒ Ø£ÙŠ Ø´Ø±Ø· ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ email
âŒ Ø£ÙŠ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø®Ø²Ù†Ø© ÙÙŠ LocalStorage

âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ù…Ø¬

âœ”ï¸ Ø§Ù„Ù…Ø§Ù„Ùƒ ÙŠØ±Ù‰ ÙƒÙ„ Ø´ÙŠØ¡ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
âœ”ï¸ Ø§Ù„Ø£Ø¯Ù…Ù† ÙŠØªØ­ÙƒÙ… Ø­Ø³Ø¨ Ù…Ø§ ØªØ¹Ø·ÙŠÙ‡
âœ”ï¸ Ø§Ù„Ù…ÙˆØ¸Ù ÙŠØ±Ù‰ ÙÙ‚Ø· Ø§Ù„Ù…ØµØ±Ù‘Ø­ Ù„Ù‡
âœ”ï¸ Ù„Ø§ Ø²Ø± ÙŠØ¸Ù‡Ø± Ø¨Ø§Ù„ØºÙ„Ø·
âœ”ï¸ Ù„Ø§ ØµÙØ­Ø© ØªÙÙØªØ­ Ø¨Ø¯ÙˆÙ† Ø¥Ø°Ù†
âœ”ï¸ Ù†Ø¸Ø§Ù… Ù†Ø¸ÙŠÙØŒ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ³Ø¹ØŒ ÙˆÙ…Ø¤Ø³Ø³ÙŠ