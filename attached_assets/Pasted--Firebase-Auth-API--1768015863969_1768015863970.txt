ููุฏ ุดุบูุงู ูููุฑุฉ ุนุงูุฉ (ูุงุฌูุฉ + Firebase Auth + ุฑูุน ูููุงุช + ุฅุฑุณุงู ููู API + ุนุฑุถ ุชูุฑูุฑ)ุ ููู ููู ูู ุฎูู ููู: ุจุนุถูุง โููุณุฑ ูุธุงุฆูโ ูุจุนุถูุง โูุฎุงุทุฑ ุฃูููุฉ/ุงุณุชูุฑุงุฑโ ูุจุนุถูุง โุฃุฏุงุกโ.

ุณุฃูุณููุง ุญุณุจ ุงูุฃููููุฉ ูุน ุญู ุณุฑูุน ููู ููุทุฉ.

1) ุฃุฎุทุฑ ูุดููุฉ ุฃูููุฉ ุนูุฏู: ุงุณุชุฎุฏุงู innerHTML ูุน ุจูุงูุงุช ูููู ูุบููุฑูุง ุงููุณุชุฎุฏู (XSS)
ุฃููุ

userInfo.innerHTML = ... ${currentUser.name}
ุงุณู ุงููุณุชุฎุฏู (Google displayName) ุบูุฑ ูุถููู 100% ููุฏ ูุญุชูู ุฑููุฒ HTML.

ุจูุงุก printHeader ูููู ${doctorName} ุฏุงุฎู HTML string ูุจู ูุง ุชุนูู sanitize ููุชูุฑูุฑ.

ูุฐูู viewSignature() ููุชุจ HTML ูู ูุงูุฐุฉ ุฌุฏูุฏุฉ ููุถุน img src ูู ุงูุจูุงูุงุช.

ููุงุฐุง ูุฐุง ุฎุทูุฑุ

OWASP ููุตู: ุฅุฐุง ุงููุญุชูู ูุตููุ ุงุณุชุฎุฏู textContent ุจุฏู innerHTML ูุชุฌููุจ XSS. 
OWASP Cheat Sheet Series
+2
OWASP Cheat Sheet Series
+2

ูุฃูุช ุชุณุชุฎุฏู DOMPurify ููุชูุฑูุฑ (ููุชุงุฒ) ููู ุชุฏุฎู ููู (doctorName/userName) ุฎุงุฑุฌ sanitization.

ุงูุญู ุงูุณุฑูุน

ุจุฏูู ุงูุฃูุงูู ุงููุตููุฉ ุฅูู textContent ุฃู ุงุนูู Escape/DOMPurify ุนูู ุงููุต ููุท.

ูุซุงู ุขูู ูุนุฑุถ ุงุณู ุงููุณุชุฎุฏู:

userInfo.textContent = `๐ค ${currentUser.name}`;


ููู doctorName ูุจู ุฅุฏุฎุงูู ูู HTML:

const safeDoctor = (typeof DOMPurify !== "undefined")
  ? DOMPurify.sanitize(doctorName, {ALLOWED_TAGS: [], ALLOWED_ATTR: []})
  : doctorName.replace(/[<>&"']/g, s => ({'<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;',"'":'&#39;'}[s]));


DOMPurify ูุตูู ููุฐุง ุงูููุน ูู ุงูุงุณุชุฎุฏุงู ูุชุตููุฉ HTML ุบูุฑ ุงูููุซูู. 
DOMPurify
+1

2) ุซุบุฑุฉ ุชุดุบูููุฉ/ุฃูููุฉ ูุจูุฑุฉ: ุฑูุงุจุท ุงูู Backends ุนูุฏู ูููู ุชูุณุชุฏุนู ุจุฏูู ุฅุซุจุงุช ูููุฉ (Token)

ุฃูุช ุชุนุชูุฏ ุนูู ุฃู ุงููุณุชุฎุฏู โุฏุฎู Firebaseโ ุซู ุชุชุตู ุจู:

Apps Script endpoint (BACKEND_URL)

Tasks endpoints (?action=getTasks, createTask, โฆ)

Replit endpoint (API_URL)

ููู ูู ุงูููุฏ ูุง ููู ุฃู ุฅุฑุณุงู ูู Firebase ID Token ุฃู App Check token ููุจุงููุฏุ ููุฐุง ูุนูุงู:

ูู ุงูู Apps Script ูุง ูุชุญูู ุจููุณูุ ุฃู ุดุฎุต ูุนุฑู ุงูุฑุงุจุท ููุฏุฑ ูุฌุฑุจ ูุณุชุฏุนูู.

ููุณ ุงูุดูุก ููู Replit endpoint.

Firebase App Check ูุตูู ุชุญุฏูุฏูุง ูุญูุงูุฉ ุงูู backends ูู ุฅุณุงุกุฉ ุงูุงุณุชุฎุฏุงู ููุดุฑุญ ููู ุชุฑุณู token ูุชุชุญูู ููู ูู ุงูุจุงููุฏ. 
Firebase
+2
Firebase
+2

ุงูุญู (ูุฎุชุตุฑ):

ุนูู ุงูุนููู: ุฃุฑุณู Authorization: Bearer <Firebase ID token> ุฃู App Check token.

ุนูู ุงูุฎุงุฏู: ุชุญูู ูู ุงูุชููู (Admin SDK) ูุงุฑูุถ ุฃู ุทูุจ ุจุฏููู.

3) ูุดููุฉ โุชูุณุฑ ุงูุชุญููู ุฃุญูุงููุงโ: ุญูู base64 ุนูุฏู ููุณ Base64 ุฏุงุฆููุง

ูู filesForAnalysis:

base64: f.data || f.textContent || ''


ููู:

ุงูุตูุฑ ุนูุฏู f.data = DataURL ูุงูู (data:image/jpeg;base64,...) ูุด base64 ุฎุงู

Excel ุนูุฏู f.data = base64 ุฎุงู (ุจุฏูู prefix)

manual-input = ูุต ุฎุงู (ูุด base64 ุฃุตูุงู)

ููู tasks analysis ุฃูุช ุชุถูู Excel ูู mimeType: 'text/plain' ู data: textContent (ูุต) ููู ุชุณููู base64.

ูุฐุง ูุณุจุจ ุฃู ุงูู backend ูุญุชุงุฑ: ูู ูู โbase64โุ ููุง โูุตโุ ููุง โdataURLโุ

ุงูุญู ุงูุณุฑูุน: ูุญูุฏ ุงูุดูู

ุงุฑุณู:

content: ุงููุต ุงููุณุชุฎุฑุฌ (ููู LLM)

ุฃู base64Raw: base64 ุฎุงู ุจุฏูู prefix

ูุฎุงูุฉ isDataUrl ุฃู ุชุนุงูู ูู ุงูุนููู: ูุตู ุงูู prefix ูู ููุฌูุฏ.

ูุซุงู:

function toRawBase64(data) {
  if (typeof data !== "string") return "";
  const m = data.match(/^data:.*?;base64,(.*)$/);
  return m ? m[1] : data; // ูู already raw
}

const filesForAnalysis = filesToSend.map(f => ({
  name: f.name,
  base64: toRawBase64(f.data || ""),
  text: f.textContent || "",
  type: f.mimeType || "text/plain"
}));

4) ูุดููุฉ ุฃุฏุงุก/ุชุนููู ุงููุชุตูุญ: ุชุญููู ูู ุตูุญุฉ PDF ุฅูู ุตูุฑุฉ Base64

ูุฐุง ุงูุฌุฒุก:

ูุฑูุฏุฑ ูู ุตูุญุฉ Canvas

ุซู toDataURL ููุฎุฒูููุง ูู ุงูุฐุงูุฑุฉ

ููุนูู renderFiles() ุจุนุฏ ูู ุตูุญุฉ

ูุน PDF ูุจูุฑ = ุชุฌูุฏ ุงูุตูุญุฉ/ุงุณุชููุงู RAM ุนุงูู ุฌุฏูุง.

ุญููู ุณุฑูุนุฉ:

ุญุฏ ุฃูุตู ููุตูุญุงุช (ูุซูุงู 10โ20) ุฃู ุฎูุงุฑ โุงุฎุชุฑ ุตูุญุงุชโ.

ุจุฏู ุงูุตูุฑ: ุงุณุชุฎุฑุฌ ูุต PDF ุฅู ุฃููู (ุฃุฎู ุจูุซูุฑ).

ูุง ุชุนูู renderFiles() ุจุนุฏ ูู ุตูุญุฉุ ุงุนูููุง ูู 3โ5 ุตูุญุงุช.

5) ุฎูู ููุทูู ูุงุถุญ ูู ุชููููุงุช AI: ูุง ููุชูุท ุงูุฃุฑูุงู ุงูุนุดุฑูุฉ (ูุซู 6.4/10)

ูู extractAndApplyAIRatings ุฃูุช ุชุณุชุฎุฏู:

(\d+)\s*\/\s*10


ูุฐุง ููุชูุท 6/10 ููู ูู ููุชูุท 6.4/10 (ููู ููุฌูุฏ ูู ุชูุงุฑูุฑู).

ุงูุญู:

/(\d+(?:\.\d+)?)\s*\/\s*10/

6) ูุธุงุฆู โููุฌูุฏุฉ ูู ุงูููุฏ ููู ูุด ุดุบูุงูุฉโ (IDs ุบูุฑ ููุฌูุฏุฉ / CSS ูุฎูููุง)

ุฃูุซูุฉ:

ุฒุฑ ููุฑุณ ุงูุชูุฑูุฑ #reportTocToggle ููุฌูุฏ ูู HTML ููู ูู CSS:

.report-toc-toggle { display: none; }


ูุนูู ุงูููุฑุณ ุบุงูุจูุง ูู ููุชุญ ูููุณุชุฎุฏู ุฅูุง ุฅุฐุง ูุชุญุช ุงูู aside ุจุฑูุฌููุง.

ุนูุฏู ุฏูุงู ุชุชุนุงูู ูุน ุนูุงุตุฑ ุบูุฑ ููุฌูุฏุฉ (ูุด ูุงุฑุซุฉ ุจุณุจุจ ?. ููู ูุฏู ุนูู ุชูุฏูุณ):

imageFilePicker/pdfFilePicker/excelFilePicker

scrollTopBtn/scrollBottomBtn

toggleReportTOC() ุชุณุชุฎุฏู IDs ูุฎุชููุฉ ุนู toggleReportToc()

ุงูุญู: ูุธูู ุฃู ูุนูู ุงูุนูุงุตุฑ ูุนูููุง ุญุชู ูุง ูุตูุฑ ุณููู โุบุงูุถโ.

7) ุงุนุชูุงุฏ ูุจูุฑ ุนูู CDNs ุจุฏูู SRI (ุฃูุถู ููุงุฑุณุฉ)

ุฃูุช ุชุญูู ููุชุจุงุช ูุซูุฑุฉ ุนุจุฑ CDN. ุงูุฃูุถู ุฅุถุงูุฉ integrity ู crossorigin="anonymous" ูุชูููู ุฎุทุฑ ุงูุนุจุซ ุจุณูุฑุจุชุงุช ุงูุทุฑู ุงูุซุงูุซ. MDN ุชุดุฑุญ Subresource Integrity ูููู ูุนูู. 
MDN Web Docs
+2
MDN Web Docs
+2

ููุงุญุธุฉ ุนู Firebase API Key

ูุฌูุฏ apiKey ูู ุงููุงุฌูุฉ ููุณ ุณุฑูุง ุจุญุฏ ุฐุงุชู (Firebase ููุณูุง ุชููู API key ููุชุนุฑูู ูููุณ ููุชุญูู ุจุงููุตูู) ููู ุงูุฃูุงู ุงูุญูููู ูุงุฒู ูููู ุนุจุฑ Security Rules + ุงูุชุญูู ูู ุงููููุฉ/ุงูุชููู ูู ุงูุจุงููุฏ. 
Firebase
+1

ูู ุชุจุบุงูู ุฃููู โุฃูุซุฑ ุฎูู ุบุงูุจูุง ูุณุจุจ ูุดุงูู ุนูุฏู ุงูุขูโ

ุนุฏู ุชูุญูุฏ base64/text โ ุงูุชุญููู ููุดู ุฃู ูุนุทู ูุชุงุฆุฌ ุถุนููุฉ/ุบุฑูุจุฉ.

XSS ุนุจุฑ innerHTML (ุฎุตูุตูุง userInfo ู doctorName). 
OWASP Cheat Sheet Series
+1

PDF ูุจูุฑ โ ุชุนููู/Crash.