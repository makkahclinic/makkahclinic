ğŸ§± Ø§ÙØªØ±Ø§Ø¶Ø§Øª Ø¨Ø³ÙŠØ·Ø© (Ù…Ù‡Ù…Ø©)

Ù‡Ø°Ø§ Ø§Ù„Ø­Ù„ ÙŠÙØªØ±Ø¶ Ø£Ù†:

Ù„Ø¯ÙŠÙƒ Backend ÙÙŠÙ‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© addFollowUp

ÙˆØ´ÙŠØª Ø§Ø³Ù…Ù‡:

Rounds_FollowUps


Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙƒÙ…Ø§ Ø§ØªÙÙ‚Ù†Ø§:

FollowUp_ID
Round_RowIndex
Area
Execution_Responsible
Follower_Name
FollowUp_Notes
Created_At
Created_Date

ğŸŸ¢ Ø§Ù„Ø¬Ø²Ø¡ 1: Ø¥Ø¶Ø§ÙØ© API Ø¬Ø¯ÙŠØ¯ (Backend ØµØºÙŠØ± Ø¬Ø¯Ù‹Ø§)

Ø£Ø¶ÙŠÙÙ‡ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· (Ø¶Ø±ÙˆØ±ÙŠ Ù„Ù„ÙØ±ÙˆÙ†Øª)

function getFollowUpsByRound(payload) {
  const rowIndex = payload.rowIndex;
  if (!rowIndex || rowIndex < 2) return { followUps: [] };

  const sh = SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName('Rounds_FollowUps');
  if (!sh) return { followUps: [] };

  const data = sh.getDataRange().getValues();
  const headers = data[0];

  const result = [];

  for (let i = 1; i < data.length; i++) {
    if (Number(data[i][headers.indexOf('Round_RowIndex')]) === Number(rowIndex)) {
      result.push({
        id: data[i][headers.indexOf('FollowUp_ID')],
        follower: data[i][headers.indexOf('Follower_Name')],
        notes: data[i][headers.indexOf('FollowUp_Notes')],
        createdAt: data[i][headers.indexOf('Created_At')]
      });
    }
  }

  // Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ù‹Ø§
  result.sort((a, b) => String(b.createdAt).localeCompare(String(a.createdAt)));

  return { followUps: result };
}


ÙˆÙ„Ø§ ØªÙ†Ø³Ù Ø¥Ø¶Ø§ÙØªÙ‡ ÙÙŠ doPost:

case 'getFollowUpsByRound':
  result = getFollowUpsByRound(payload);
  break;

ğŸŸ¢ Ø§Ù„Ø¬Ø²Ø¡ 2: Frontend ÙƒØ§Ù…Ù„ (Ø§Ù†Ø³Ø® ÙƒÙ…Ø§ Ù‡Ùˆ)
1ï¸âƒ£ Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø§Øª
async function loadFollowUps(rowIndex) {
  const res = await callApi('getFollowUpsByRound', { rowIndex });
  return res.followUps || [];
}

2ï¸âƒ£ HTML â€“ Ø­Ø§ÙˆÙŠØ© Ø§Ù„ØªØ§ÙŠÙ…Ù„Ø§ÙŠÙ† (ØªÙÙˆØ¶Ø¹ Ø¯Ø§Ø®Ù„ ÙƒØ±Øª Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©)
<div class="followups-container mt-3" id="followups-{{ROW_INDEX}}">
  <div class="text-muted small text-center">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø§Øª...</div>
</div>


Ù„Ø§Ø­Ù‚Ù‹Ø§ Ù†Ø³ØªØ¨Ø¯Ù„ {{ROW_INDEX}} Ø¨Ø±Ù‚Ù… Ø§Ù„ØµÙ

3ï¸âƒ£ CSS (Ø¬Ù…Ø§Ù„ÙŠ â€“ Ø®ÙÙŠÙ â€“ Ø§Ø­ØªØ±Ø§ÙÙŠ)
<style>
.followup-timeline {
  border-right: 3px solid #0d6efd;
  padding-right: 12px;
  margin-top: 10px;
}
.followup-item {
  background: #f8f9fa;
  border-radius: 10px;
  padding: 10px 12px;
  margin-bottom: 8px;
  position: relative;
}
.followup-item::before {
  content: '';
  position: absolute;
  right: -11px;
  top: 14px;
  width: 10px;
  height: 10px;
  background: #0d6efd;
  border-radius: 50%;
}
.followup-name {
  font-weight: 700;
  color: #0d6efd;
}
.followup-date {
  font-size: 0.75rem;
  color: #6c757d;
}
.followup-notes {
  font-size: 0.85rem;
  margin-top: 4px;
}
</style>

4ï¸âƒ£ JS â€“ Ø±Ø³Ù… Ø§Ù„ØªØ§ÙŠÙ…Ù„Ø§ÙŠÙ† (Ø§Ù„Ø³Ø­Ø± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ âœ¨)
async function renderFollowUps(rowIndex) {
  const container = document.getElementById(`followups-${rowIndex}`);
  if (!container) return;

  try {
    const followUps = await loadFollowUps(rowIndex);

    if (!followUps.length) {
      container.innerHTML = `
        <div class="alert alert-info py-2 small text-center">
          Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØªØ§Ø¨Ø¹Ø§Øª Ù…Ø³Ø¬Ù„Ø©
        </div>`;
      return;
    }

    container.innerHTML = `
      <div class="followup-timeline">
        ${followUps.map(f => `
          <div class="followup-item">
            <div class="followup-name">
              <i class="fas fa-user-check me-1"></i>${f.follower}
            </div>
            <div class="followup-date">
              <i class="fas fa-clock me-1"></i>${f.createdAt}
            </div>
            ${f.notes ? `<div class="followup-notes">${f.notes}</div>` : ''}
          </div>
        `).join('')}
      </div>
    `;
  } catch (e) {
    container.innerHTML = `
      <div class="alert alert-danger py-2 small text-center">
        ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø§Øª
      </div>`;
  }
}

5ï¸âƒ£ Ø±Ø¨Ø·Ù‡Ø§ Ù…Ø¹ ÙƒØ±Øª Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© (Ø³Ø·Ø± ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·)

Ø¨Ø¹Ø¯ Ø¹Ø±Ø¶ ÙƒØ±Øª Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©:

renderFollowUps(rowIndex);


ğŸ¯ Ù‡Ø°Ø§ ÙƒÙ„ Ø´ÙŠØ¡