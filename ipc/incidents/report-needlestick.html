<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>๐ฉบ ูููุฐุฌ ุงูุฅุจูุงุบ ุนู ุงูุชุนุฑุถ ุงููููู โ ูุฌูุน ููุฉ ุงูุทุจู ุจุงูุฒุงูุฑ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --maroon: #7B1E24;
      --burgundy: #9e2b2b;
      --gold: #E9C46A;
      --sand: #FDF8F5;
    }

    body {
      font-family: 'Tajawal', sans-serif;
      background: var(--sand);
      background-image: radial-gradient(circle at top left, #fff 25%, #f9f2ef 80%);
    }

    .header {
      background: linear-gradient(to right, var(--maroon), var(--burgundy));
      color: white;
      border-bottom: 6px solid var(--gold);
    }

    .card {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      transition: transform 0.3s ease;
    }

    .card:hover { transform: translateY(-3px); }

    .label { color: var(--maroon); font-weight: 700; }

    .btn {
      background-color: var(--maroon);
      color: white;
      padding: 12px 28px;
      border-radius: 12px;
      font-weight: 700;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .btn:hover {
      background-color: var(--gold);
      color: #3b2f2f;
      transform: translateY(-1px);
    }

    footer {
      margin-top: 40px;
      text-align: center;
      color: #777;
      font-size: 0.85rem;
    }
  </style>
</head>

<body class="p-4">

  <!-- ุฑุฃุณ ุงูุตูุญุฉ -->
  <header class="header py-6 text-center rounded-b-xl shadow">
    <img src="https://raw.githubusercontent.com/makkahclinic/makkahclinic/main/logo.png"
         alt="ุดุนุงุฑ ุงููุฌูุน" class="mx-auto h-20 mb-3">
    <h1 class="text-3xl md:text-4xl font-extrabold">ูููุฐุฌ ุงูุฅุจูุงุบ ุนู ุงูุชุนุฑุถ ุงููููู</h1>
    <p class="text-lg mt-2 text-[var(--gold)]">ูุฎุฒู โ ุฏููู โ ุฑุฐุงุฐ ูุฎุงุทู</p>
    <p class="text-sm text-gray-100 mt-1">ูุฌูุฉ ููุงูุญุฉ ุงูุนุฏูู โ ูุฌูุน ููุฉ ุงูุทุจู ุจุงูุฒุงูุฑ</p>
  </header>

  <!-- ุงููููุฐุฌ -->
  <section class="max-w-4xl mx-auto mt-10 card p-8 space-y-6">
    <h2 class="text-2xl font-extrabold text-[var(--maroon)] text-center border-b-2 border-[var(--gold)] pb-3">
      ๐ ุชุนุจุฆุฉ ุจูุงุบ ุงูุชุนุฑุถ ุงููููู
    </h2>

    <form id="exposureForm" class="space-y-6" autocomplete="off" novalidate>
      <!-- ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ -->
      <div>
        <h3 class="text-xl font-bold text-[var(--maroon)] mb-3">ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h3>
        <div class="grid md:grid-cols-2 gap-4">
          <div><label class="label">ุงูุงุณู ุงููุงูู</label>
               <input name="fullname" class="w-full border p-2 rounded" required></div>
          <div><label class="label">ุงููุณู / ุงููุญุฏุฉ</label>
               <input name="department" class="w-full border p-2 rounded" required></div>
          <div><label class="label">ุงููุธููุฉ</label>
               <input name="position" class="w-full border p-2 rounded"></div>
          <div><label class="label">ุชุงุฑูุฎ ุงูุญุงุฏุซ</label>
               <input type="date" name="date" class="w-full border p-2 rounded" required></div>
          <div><label class="label">ุงูููุช</label>
               <input type="time" name="time" class="w-full border p-2 rounded" required></div>
        </div>
      </div>

      <!-- ููุน ุงูุชุนุฑุถ -->
      <div>
        <h3 class="text-xl font-bold text-[var(--maroon)] mb-3">ููุน ุงูุชุนุฑุถ</h3>
        <select id="exposureType" name="exposure_type" class="w-full border p-2 rounded" required>
          <option value="">ุงุฎุชุฑ ููุน ุงูุชุนุฑุถ</option>
          <option value="needle">ูุฎุฒู (ุฅุจุฑุฉ ุฃู ุฃุฏุงุฉ ุญุงุฏุฉ)</option>
          <option value="blood">ุชุนุฑุถ ุฏููู / ุณูุงุฆู ุฌุณุฏูุฉ</option>
          <option value="mucosal">ุชูุงูุณ ุงูุฃุบุดูุฉ ุงููุฎุงุทูุฉ</option>
        </select>

        <div id="needleSection" class="hidden space-y-2 mt-3">
          <label class="label">ููุน ุงูุฃุฏุงุฉ</label>
          <select name="instrument" class="w-full border p-2 rounded">
            <option value="">ุงุฎุชุฑ</option><option>ุฅุจุฑุฉ</option><option>ูุดุฑุท</option><option>ุฃุฏุงุฉ ุฃุฎุฑู</option>
          </select>

          <label class="label">ูู ูุงูุช ูููุซุฉุ</label>
          <select name="contaminated" class="w-full border p-2 rounded">
            <option value="">ุงุฎุชุฑ</option><option>ูุนู</option><option>ูุง</option>
          </select>

          <label class="label">ููุถุน ุงูุฅุตุงุจุฉ</label>
          <input name="injury_site" class="w-full border p-2 rounded" placeholder="ูุซุงู: ุฅุตุจุน ุงููุฏ ุงููููู">
        </div>

        <div id="bloodSection" class="hidden space-y-2 mt-3">
          <label class="label">ููุงู ุงูุชูุงูุณ</label>
          <input name="contact_area" class="w-full border p-2 rounded" placeholder="ุฌุฑุญ / ุฌูุฏ ูุชุดูู">
          <label class="label">ููุน ุงูุณุงุฆู</label>
          <input name="fluid_type" class="w-full border p-2 rounded" placeholder="ุฏู / ุณูุงุฆู ุฌุณุฏูุฉ">
          <label class="label">ูููุฉ ุงูุณุงุฆู</label>
          <input name="fluid_amount" class="w-full border p-2 rounded" placeholder="ููููุฉ / ูุชูุณุทุฉ / ูุซูุฑุฉ">
        </div>
      </div>

      <!-- ุงูุฅุฌุฑุงุกุงุช ุงูููุฑูุฉ -->
      <div>
        <h3 class="text-xl font-bold text-[var(--maroon)] mb-3">ุงูุฅุฌุฑุงุกุงุช ุงูููุฑูุฉ</h3>
        <div class="space-y-2">
          <label><input type="checkbox" name="washed" value="ูุนู"> ุชู ุบุณู ุงูููุทูุฉ</label><br>
          <label><input type="checkbox" name="reported" value="ูุนู"> ุชู ุงูุฅุจูุงุบ</label><br>
          <label><input type="checkbox" name="medical_eval" value="ูุนู"> ุชู ุงูุชูููู ุงูุทุจู</label><br>
          <label><input type="checkbox" name="pep" value="ูุนู"> ุชู ุงูุจุฏุก ุจุงูุนูุงุฌ ุงูููุงุฆู (PEP)</label>
        </div>
      </div>

      <!-- ููุงุญุธุงุช -->
      <div>
        <label class="label block mb-1">ููุงุญุธุงุช ุฅุถุงููุฉ</label>
        <textarea name="notes" class="w-full border p-2 rounded" rows="3"
                  placeholder="ุฃู ุชูุงุตูู ุฅุถุงููุฉ..."></textarea>
      </div>

      <!-- ุฒุฑ ุงูุฅุฑุณุงู -->
      <div class="text-center mt-6">
        <button type="submit" id="submitBtn" class="btn">๐ค ุฅุฑุณุงู ุงูุจูุงุบ</button>
        <div id="statusMsg" class="text-sm mt-3 text-gray-600"></div>
      </div>
    </form>
  </section>

  <!-- ุฒุฑ ุงูุณุฌู -->
  <div class="text-center mt-10">
    <button id="openLogBtn" class="btn bg-[var(--gold)] text-black hover:bg-[#f3cf73]">
      ๐ ุนุฑุถ ุณุฌู ุงูุฅุตุงุจุงุช
    </button>
  </div>

  <footer>ยฉ 2025 ูุฌูุน ููุฉ ุงูุทุจู ุจุงูุฒุงูุฑ โ ูุฌูุฉ ููุงูุญุฉ ุงูุนุฏูู</footer>

  <script>
    // ุฅุธูุงุฑ ูุฅุฎูุงุก ุฃูุณุงู ููุน ุงูุชุนุฑุถ
    const exposureType = document.getElementById('exposureType');
    const needleSection = document.getElementById('needleSection');
    const bloodSection = document.getElementById('bloodSection');

    function handleExposureTypeChange() {
      needleSection.classList.add('hidden');
      bloodSection.classList.add('hidden');
      if (exposureType.value === 'needle') needleSection.classList.remove('hidden');
      else if (['blood', 'mucosal'].includes(exposureType.value)) bloodSection.classList.remove('hidden');
    }
    exposureType.addEventListener('change', handleExposureTypeChange);

    // ุฅุฑุณุงู ุงููููุฐุฌ ุฅูู Google Sheets
    document.getElementById('exposureForm').addEventListener('submit', async e => {
      e.preventDefault();
      const btn = document.getElementById('submitBtn');
      const msg = document.getElementById('statusMsg');
      btn.disabled = true; btn.textContent = 'โณ ุฌุงุฑู ุงูุฅุฑุณุงู...'; msg.textContent = '';

      try {
        const res = await fetch("https://script.google.com/macros/s/XXXXXXXXXXXXXXXXXXXXXXXXXXXX/exec", {
          method: 'POST',
          body: new FormData(e.target)
        });

        const json = await res.json();
        if (json.status === 'success') {
          msg.textContent = 'โ ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ. ุณุชุชุงุจุน ูุฌูุฉ ููุงูุญุฉ ุงูุนุฏูู ูุนู.';
          msg.style.color = 'green';
          e.target.reset();
          handleExposureTypeChange();
        } else throw new Error(json.message);

      } catch (err) {
        msg.textContent = 'โ ูุดู ุงูุฅุฑุณุงู: ' + err.message;
        msg.style.color = 'red';
      } finally {
        btn.disabled = false;
        btn.textContent = '๐ค ุฅุฑุณุงู ุงูุจูุงุบ';
      }
    });

    // ุฒุฑ ูุชุญ ุงูุณุฌู
    document.getElementById('openLogBtn').addEventListener('click', () => {
      const pass = prompt('๐ ุงูุฑุฌุงุก ุฅุฏุฎุงู ูููุฉ ุงูุณุฑ ูููุตูู ุฅูู ุณุฌู ุงูุฅุตุงุจุงุช:');
      if (pass === 'BostonYYYY2025') {
        window.open('https://docs.google.com/spreadsheets/d/11ASpiUe6GTW4siaoPGnjqG3xKMeUdCmxPsTSbPTu9xw/edit#gid=0', '_blank');
      } else if (pass !== null) {
        alert('โ ูููุฉ ุงูุณุฑ ุบูุฑ ุตุญูุญุฉ.');
      }
    });
  </script>
</body>
</html>
